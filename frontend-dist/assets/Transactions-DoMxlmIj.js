import{a4 as lt,j as t,r as b,_ as it,l as mt,I as q,a5 as bt,a6 as ft,e as n,d as jt,g as yt,u as Pt,a7 as l,a8 as et,s as M,f as J,a9 as Bt,aa as vt,h as It,q as F,p as Ct,ab as ct,U as wt,B,Y as St,P as st,T as h,G as $,F as Y,H as X,ac as V,ad as Rt,ae as Tt,af as kt,ag as Lt,ah as $t,ai as Mt,aj as At,ak as Dt,al as _t,am as ot,an as Ft,J as nt,ao as at}from"./index-DKVd45z4.js";import{T as Nt}from"./TrendingDown-D5M8qhVY.js";const Et=lt(t.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),Ht=lt(t.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),Wt=["backIconButtonProps","count","disabled","getItemAriaLabel","nextIconButtonProps","onPageChange","page","rowsPerPage","showFirstButton","showLastButton","slots","slotProps"],zt=b.forwardRef(function(o,j){var y,C,w,N,v,A,S,x;const{backIconButtonProps:i,count:R,disabled:T=!1,getItemAriaLabel:c,nextIconButtonProps:D,onPageChange:I,page:r,rowsPerPage:f,showFirstButton:P,showLastButton:k,slots:p={},slotProps:a={}}=o,_=it(o,Wt),e=mt(),u=L=>{I(L,0)},E=L=>{I(L,r-1)},H=L=>{I(L,r+1)},d=L=>{I(L,Math.max(0,Math.ceil(R/f)-1))},g=(y=p.firstButton)!=null?y:q,W=(C=p.lastButton)!=null?C:q,z=(w=p.nextButton)!=null?w:q,K=(N=p.previousButton)!=null?N:q,U=(v=p.firstButtonIcon)!=null?v:Et,Q=(A=p.lastButtonIcon)!=null?A:Ht,m=(S=p.nextButtonIcon)!=null?S:bt,Z=(x=p.previousButtonIcon)!=null?x:ft,ut=e?W:g,dt=e?z:K,ht=e?K:z,xt=e?g:W,pt=e?a.lastButton:a.firstButton,O=e?a.nextButton:a.previousButton,tt=e?a.previousButton:a.nextButton,gt=e?a.firstButton:a.lastButton;return t.jsxs("div",n({ref:j},_,{children:[P&&t.jsx(ut,n({onClick:u,disabled:T||r===0,"aria-label":c("first",r),title:c("first",r)},pt,{children:e?t.jsx(Q,n({},a.lastButtonIcon)):t.jsx(U,n({},a.firstButtonIcon))})),t.jsx(dt,n({onClick:E,disabled:T||r===0,color:"inherit","aria-label":c("previous",r),title:c("previous",r)},O??i,{children:e?t.jsx(m,n({},a.nextButtonIcon)):t.jsx(Z,n({},a.previousButtonIcon))})),t.jsx(ht,n({onClick:H,disabled:T||(R!==-1?r>=Math.ceil(R/f)-1:!1),color:"inherit","aria-label":c("next",r),title:c("next",r)},tt??D,{children:e?t.jsx(Z,n({},a.previousButtonIcon)):t.jsx(m,n({},a.nextButtonIcon))})),k&&t.jsx(xt,n({onClick:d,disabled:T||r>=Math.ceil(R/f)-1,"aria-label":c("last",r),title:c("last",r)},gt,{children:e?t.jsx(U,n({},a.firstButtonIcon)):t.jsx(Q,n({},a.lastButtonIcon))}))]}))});function Ut(s){return yt("MuiTablePagination",s)}const G=jt("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]);var rt;const Vt=["ActionsComponent","backIconButtonProps","className","colSpan","component","count","disabled","getItemAriaLabel","labelDisplayedRows","labelRowsPerPage","nextIconButtonProps","onPageChange","onRowsPerPageChange","page","rowsPerPage","rowsPerPageOptions","SelectProps","showFirstButton","showLastButton","slotProps","slots"],Gt=M(l,{name:"MuiTablePagination",slot:"Root",overridesResolver:(s,o)=>o.root})(({theme:s})=>({overflow:"auto",color:(s.vars||s).palette.text.primary,fontSize:s.typography.pxToRem(14),"&:last-child":{padding:0}})),Kt=M(Ct,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(s,o)=>n({[`& .${G.actions}`]:o.actions},o.toolbar)})(({theme:s})=>({minHeight:52,paddingRight:2,[`${s.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[s.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${G.actions}`]:{flexShrink:0,marginLeft:20}})),Qt=M("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(s,o)=>o.spacer})({flex:"1 1 100%"}),qt=M("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(s,o)=>o.selectLabel})(({theme:s})=>n({},s.typography.body2,{flexShrink:0})),Jt=M(ct,{name:"MuiTablePagination",slot:"Select",overridesResolver:(s,o)=>n({[`& .${G.selectIcon}`]:o.selectIcon,[`& .${G.select}`]:o.select},o.input,o.selectRoot)})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${G.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),Yt=M(F,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(s,o)=>o.menuItem})({}),Xt=M("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(s,o)=>o.displayedRows})(({theme:s})=>n({},s.typography.body2,{flexShrink:0}));function Zt({from:s,to:o,count:j}){return`${s}–${o} of ${j!==-1?j:`more than ${o}`}`}function Ot(s){return`Go to ${s} page`}const te=s=>{const{classes:o}=s;return It({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},Ut,o)},ee=b.forwardRef(function(o,j){var y;const C=Pt({props:o,name:"MuiTablePagination"}),{ActionsComponent:w=zt,backIconButtonProps:N,className:v,colSpan:A,component:S=l,count:x,disabled:i=!1,getItemAriaLabel:R=Ot,labelDisplayedRows:T=Zt,labelRowsPerPage:c="Rows per page:",nextIconButtonProps:D,onPageChange:I,onRowsPerPageChange:r,page:f,rowsPerPage:P,rowsPerPageOptions:k=[10,25,50,100],SelectProps:p={},showFirstButton:a=!1,showLastButton:_=!1,slotProps:e={},slots:u={}}=C,E=it(C,Vt),H=C,d=te(H),g=(y=e==null?void 0:e.select)!=null?y:p,W=g.native?"option":Yt;let z;(S===l||S==="td")&&(z=A||1e3);const K=et(g.id),U=et(g.labelId),Q=()=>x===-1?(f+1)*P:P===-1?x:Math.min(x,(f+1)*P);return t.jsx(Gt,n({colSpan:z,ref:j,as:S,ownerState:H,className:J(d.root,v)},E,{children:t.jsxs(Kt,{className:d.toolbar,children:[t.jsx(Qt,{className:d.spacer}),k.length>1&&t.jsx(qt,{className:d.selectLabel,id:U,children:c}),k.length>1&&t.jsx(Jt,n({variant:"standard"},!g.variant&&{input:rt||(rt=t.jsx(Bt,{}))},{value:P,onChange:r,id:K,labelId:U},g,{classes:n({},g.classes,{root:J(d.input,d.selectRoot,(g.classes||{}).root),select:J(d.select,(g.classes||{}).select),icon:J(d.selectIcon,(g.classes||{}).icon)}),disabled:i,children:k.map(m=>b.createElement(W,n({},!vt(W)&&{ownerState:H},{className:d.menuItem,key:m.label?m.label:m,value:m.value?m.value:m}),m.label?m.label:m))})),t.jsx(Xt,{className:d.displayedRows,children:T({from:x===0?0:f*P+1,to:Q(),count:x===-1?-1:x,page:f})}),t.jsx(w,{className:d.actions,backIconButtonProps:N,count:x,nextIconButtonProps:D,onPageChange:I,page:f,rowsPerPage:P,showFirstButton:a,showLastButton:_,slotProps:e.actions,slots:u.actions,getItemAriaLabel:R,disabled:i})]})}))}),ne=()=>{const s=wt(e=>{var u;return(u=e.companyState.data)==null?void 0:u.id}),[o,j]=b.useState(0),[y,C]=b.useState(10),[w,N]=b.useState(""),[v,A]=b.useState("all"),[S,x]=b.useState([]),[i,R]=b.useState(null),[T,c]=b.useState(!0),[D,I]=b.useState(null),r=async()=>{try{c(!0);const e=new URLSearchParams;w&&e.append("search",w),v!=="all"&&e.append("type",v);const u=await fetch(`${at}/api/transactions/${s}?${e}`);if(!u.ok)throw new Error("Failed to fetch transactions");const E=await u.json();x(E),I(null)}catch(e){I(e.message),console.error("Error fetching transactions:",e)}finally{c(!1)}},f=async()=>{try{const e=await fetch(`${at}/api/transactions/${s}/summary?period=today`);if(!e.ok)throw new Error("Failed to fetch summary");const u=await e.json();R(u)}catch(e){console.error("Error fetching summary:",e)}};b.useEffect(()=>{s&&(r(),f())},[s,w,v]);const P=e=>{switch(e){case"Sale":return"success";case"Debt Payment":return"primary";case"Vendor Payment":return"warning";case"Restock":return"info";default:return"default"}},k=e=>{switch(e){case"Completed":return"success";case"Partial":return"warning";case"Pending":return"error";default:return"default"}},p=(e,u)=>{j(u)},a=e=>{C(parseInt(e.target.value,10)),j(0)},_=S;return T?t.jsx(B,{sx:{p:3,display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:t.jsx(St,{})}):t.jsx(B,{sx:{p:2,height:"95vh",overflow:"auto",backgroundColor:"#f5f5f5"},children:t.jsxs(st,{elevation:0,sx:{p:3,backgroundColor:"#f8f9fa",maxWidth:"100%",margin:"0 auto"},children:[t.jsx(h,{variant:"h4",gutterBottom:!0,sx:{fontWeight:600,color:"#1a237e",mb:3},children:"Transactions"}),i&&t.jsxs($,{container:!0,spacing:2,sx:{mb:3},children:[t.jsx($,{item:!0,xs:12,sm:6,md:3,children:t.jsx(Y,{children:t.jsx(X,{children:t.jsxs(B,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs(B,{children:[t.jsx(h,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Today's Sales"}),t.jsxs(h,{variant:"h6",children:["₵",V(i.totalSalesReceived)]}),t.jsxs(h,{variant:"body2",color:"textSecondary",children:[i.salesCount," transactions"]})]}),t.jsx(Rt,{color:"success"})]})})})}),t.jsx($,{item:!0,xs:12,sm:6,md:3,children:t.jsx(Y,{children:t.jsx(X,{children:t.jsxs(B,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs(B,{children:[t.jsx(h,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Debt Payments"}),t.jsxs(h,{variant:"h6",children:["₵",V(i.totalDebtPayments)]}),t.jsxs(h,{variant:"body2",color:"textSecondary",children:[i.debtPaymentCount," payments"]})]}),t.jsx(Tt,{color:"primary"})]})})})}),t.jsx($,{item:!0,xs:12,sm:6,md:3,children:t.jsx(Y,{children:t.jsx(X,{children:t.jsxs(B,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs(B,{children:[t.jsx(h,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Vendor Payments"}),t.jsxs(h,{variant:"h6",children:["₵",V(i.totalVendorPayments)]}),t.jsxs(h,{variant:"body2",color:"textSecondary",children:[i.vendorPaymentCount," payments"]})]}),t.jsx(Nt,{color:"warning"})]})})})}),t.jsx($,{item:!0,xs:12,sm:6,md:3,children:t.jsx(Y,{children:t.jsx(X,{children:t.jsxs(B,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs(B,{children:[t.jsx(h,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Restocks"}),t.jsxs(h,{variant:"h6",children:["₵",V(i.totalRestockCost)]}),t.jsxs(h,{variant:"body2",color:"textSecondary",children:[i.restockCount," restocks"]})]}),t.jsx(kt,{color:"info"})]})})})})]}),D&&t.jsx(Lt,{severity:"error",sx:{mb:3},children:D}),t.jsx($,{container:!0,spacing:2,sx:{mb:3},children:t.jsx($,{item:!0,xs:12,md:4,children:t.jsxs($t,{fullWidth:!0,children:[t.jsx(Mt,{children:"Transaction Type"}),t.jsxs(ct,{value:v,label:"Transaction Type",onChange:e=>A(e.target.value),children:[t.jsx(F,{value:"all",children:"All Types"}),t.jsx(F,{value:"Sale",children:"Sales"}),t.jsx(F,{value:"Debt Payment",children:"Debt Payments"}),t.jsx(F,{value:"Vendor Payment",children:"Vendor Payments"}),t.jsx(F,{value:"Restock",children:"Restocks"})]})]})})}),t.jsx(At,{component:st,elevation:0,sx:{maxHeight:"60vh",overflow:"auto","&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#c1c1c1",borderRadius:"4px","&:hover":{backgroundColor:"#a8a8a8"}}},children:t.jsxs(Dt,{stickyHeader:!0,children:[t.jsx(_t,{children:t.jsxs(ot,{children:[t.jsx(l,{sx:{backgroundColor:"#fff",fontWeight:600},children:"Date"}),t.jsx(l,{sx:{backgroundColor:"#fff",fontWeight:600},children:"Type"}),t.jsx(l,{sx:{backgroundColor:"#fff",fontWeight:600},children:"Reference"}),t.jsx(l,{sx:{backgroundColor:"#fff",fontWeight:600},children:"Amount"}),t.jsx(l,{sx:{backgroundColor:"#fff",fontWeight:600},children:"Payment Method"}),t.jsx(l,{sx:{backgroundColor:"#fff",fontWeight:600},children:"Status"})]})}),t.jsx(Ft,{children:_.slice(o*y,o*y+y).map(e=>t.jsxs(ot,{sx:{"&:hover":{backgroundColor:"#f5f5f5"}},children:[t.jsx(l,{children:new Date(e.date).toLocaleDateString()}),t.jsx(l,{children:t.jsx(nt,{label:e.type,color:P(e.type),size:"small"})}),t.jsx(l,{children:e.reference}),t.jsxs(l,{children:["₵",V(e.amount)]}),t.jsx(l,{children:e.paymentMethod}),t.jsx(l,{children:t.jsx(nt,{label:e.status,color:k(e.status),size:"small"})})]},e.id))})]})}),t.jsx(ee,{component:"div",count:_.length,page:o,onPageChange:p,rowsPerPage:y,onRowsPerPageChange:a,rowsPerPageOptions:[5,10,25]})]})})};export{ne as default};
