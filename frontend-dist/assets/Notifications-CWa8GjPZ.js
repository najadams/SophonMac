import{d as pr,g as gr,r as x,u as ur,_ as hr,e as N,aZ as V,f as Z,s as G,j as a,m as c,h as mr,a4 as q,B as m,Y as vr,ag as fr,T as f,c as xr,F as w,aG as br,aO as yr,aH as Or,aJ as jr,J as Cr,a_ as $r,I as J,a$ as Pr,D as Rr,H as Br,a0 as C,ao as $}from"./index-GTE1N4Ws.js";import{u as K}from"./usePreviousProps-yVRdJcfX.js";import{N as I}from"./Notifications-Ccl-o-6C.js";function zr(t){const{badgeContent:e,invisible:r=!1,max:i=99,showZero:n=!1}=t,g=K({badgeContent:e,max:i});let d=r;r===!1&&e===0&&!n&&(d=!0);const{badgeContent:l,max:u=i}=d?g:t,h=l&&Number(l)>u?`${u}+`:l;return{badgeContent:l,invisible:d,max:u,displayValue:h}}function Nr(t){return gr("MuiBadge",t)}const v=pr("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),Ir=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],A=10,_=4,Ar=t=>{const{color:e,anchorOrigin:r,invisible:i,overlap:n,variant:g,classes:d={}}=t,l={root:["root"],badge:["badge",g,i&&"invisible",`anchorOrigin${c(r.vertical)}${c(r.horizontal)}`,`anchorOrigin${c(r.vertical)}${c(r.horizontal)}${c(n)}`,`overlap${c(n)}`,e!=="default"&&`color${c(e)}`]};return mr(l,Nr,d)},_r=G("span",{name:"MuiBadge",slot:"Root",overridesResolver:(t,e)=>e.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),kr=G("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.badge,e[r.variant],e[`anchorOrigin${c(r.anchorOrigin.vertical)}${c(r.anchorOrigin.horizontal)}${c(r.overlap)}`],r.color!=="default"&&e[`color${c(r.color)}`],r.invisible&&e.invisible]}})(({theme:t})=>{var e;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:A*2,lineHeight:1,padding:"0 6px",height:A*2,borderRadius:A,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.keys(((e=t.vars)!=null?e:t).palette).filter(r=>{var i,n;return((i=t.vars)!=null?i:t).palette[r].main&&((n=t.vars)!=null?n:t).palette[r].contrastText}).map(r=>({props:{color:r},style:{backgroundColor:(t.vars||t).palette[r].main,color:(t.vars||t).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:_,height:_*2,minWidth:_*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]}}),Tr=x.forwardRef(function(e,r){var i,n,g,d,l,u;const h=ur({props:e,name:"MuiBadge"}),{anchorOrigin:b={vertical:"top",horizontal:"right"},className:y,component:o,components:s={},componentsProps:p={},children:Q,overlap:k="rectangular",color:T="default",invisible:X=!1,max:rr=99,badgeContent:D,slots:O,slotProps:j,showZero:L=!1,variant:P="standard"}=h,ar=hr(h,Ir),{badgeContent:M,invisible:tr,max:or,displayValue:er}=zr({max:rr,invisible:X,badgeContent:D,showZero:L}),sr=K({anchorOrigin:b,color:T,overlap:k,variant:P,badgeContent:D}),S=tr||M==null&&P!=="dot",{color:nr=T,overlap:ir=k,anchorOrigin:lr=b,variant:E=P}=S?sr:h,W=E!=="dot"?er:void 0,R=N({},h,{badgeContent:M,invisible:S,max:or,displayValue:W,showZero:L,anchorOrigin:lr,color:nr,overlap:ir,variant:E}),F=Ar(R),H=(i=(n=O==null?void 0:O.root)!=null?n:s.Root)!=null?i:_r,U=(g=(d=O==null?void 0:O.badge)!=null?d:s.Badge)!=null?g:kr,B=(l=j==null?void 0:j.root)!=null?l:p.root,z=(u=j==null?void 0:j.badge)!=null?u:p.badge,cr=V({elementType:H,externalSlotProps:B,externalForwardedProps:ar,additionalProps:{ref:r,as:o},ownerState:R,className:Z(B==null?void 0:B.className,F.root,y)}),dr=V({elementType:U,externalSlotProps:z,ownerState:R,className:Z(F.badge,z==null?void 0:z.className)});return a.jsxs(H,N({},cr,{children:[Q,a.jsx(U,N({},dr,{children:W}))]}))}),Y=q(a.jsx("path",{d:"M12 19c0-3.87 3.13-7 7-7 1.08 0 2.09.25 3 .68V6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h8.08c-.05-.33-.08-.66-.08-1M4 6l8 5 8-5v2l-8 5-8-5zm13.34 16-3.54-3.54 1.41-1.41 2.12 2.12 4.24-4.24L23 16.34z"}),"MarkEmailRead"),Dr=q(a.jsx("path",{d:"M7.58 4.08 6.15 2.65C3.75 4.48 2.17 7.3 2.03 10.5h2c.15-2.65 1.51-4.97 3.55-6.42m12.39 6.42h2c-.15-3.2-1.73-6.02-4.12-7.85l-1.42 1.43c2.02 1.45 3.39 3.77 3.54 6.42M18 11c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-6 11c.14 0 .27-.01.4-.04.65-.14 1.18-.58 1.44-1.18.1-.24.15-.5.15-.78h-4c.01 1.1.9 2 2.01 2"}),"NotificationsActive"),Er=({companyId:t=1})=>{const[e,r]=x.useState([]),[i,n]=x.useState(!0),[g,d]=x.useState(null),l=async()=>{try{n(!0);const s=(await C.get(`${$}/api/notifications/${t}`)).data;Array.isArray(s)?r(s):(r([]),console.error("Fetched data is not an array:",s)),n(!1)}catch(o){d(o),n(!1)}},u=async o=>{try{await C.patch(`${$}/api/notifications/${o}/read`),r(s=>s.map(p=>p.id===o?{...p,status:"read"}:p))}catch(s){console.error("Error marking notification as read:",s)}},h=async o=>{try{await C.delete(`${$}/api/notifications/${o}`),r(s=>s.filter(p=>p.id!==o))}catch(s){console.error("Error deleting notification:",s)}},b=async()=>{const o=e.filter(s=>s.status==="unread");try{await Promise.all(o.map(s=>C.patch(`${$}/api/notifications/${s.id}/read`))),r(s=>s.map(p=>({...p,status:"read"})))}catch(s){console.error("Error marking all notifications as read:",s)}};x.useEffect(()=>{l()},[t]);const y=e.filter(o=>o.status==="unread").length;return i?a.jsx(m,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:a.jsx(vr,{})}):g?a.jsxs(fr,{severity:"error",sx:{m:2},children:["Error loading notifications: ",g.message]}):a.jsx("div",{className:"page",children:a.jsxs(m,{sx:{p:3},children:["Dummy Data",a.jsxs(m,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[a.jsxs(m,{display:"flex",alignItems:"center",gap:2,children:[a.jsx(Tr,{badgeContent:y,color:"error",children:a.jsx(I,{fontSize:"large"})}),a.jsx(f,{variant:"h4",component:"h1",fontWeight:300,children:"Notifications"})]}),y>0&&a.jsx(xr,{variant:"outlined",onClick:b,startIcon:a.jsx(Y,{}),children:"Mark All as Read"})]}),e.length>0?a.jsx(w,{children:a.jsx(br,{children:e.map((o,s)=>a.jsxs(yr.Fragment,{children:[a.jsxs(Or,{sx:{backgroundColor:o.status==="unread"?"action.hover":"transparent","&:hover":{backgroundColor:"action.selected"}},children:[a.jsx(m,{display:"flex",alignItems:"center",mr:2,children:o.status==="unread"?a.jsx(Dr,{color:"primary"}):a.jsx(I,{color:"disabled"})}),a.jsx(jr,{primary:a.jsxs(m,{display:"flex",alignItems:"center",gap:1,children:[a.jsx(f,{variant:"body1",sx:{fontWeight:o.status==="unread"?600:400,flex:1},children:o.message}),a.jsx(Cr,{label:o.status,size:"small",color:o.status==="unread"?"primary":"default",variant:o.status==="unread"?"filled":"outlined"})]}),secondary:a.jsx(f,{variant:"caption",color:"text.secondary",children:o.createdAt&&!isNaN(new Date(o.createdAt).getTime())?new Date(o.createdAt).toLocaleString():"Invalid Date"})}),a.jsx($r,{children:a.jsxs(m,{display:"flex",gap:1,children:[o.status==="unread"&&a.jsx(J,{edge:"end","aria-label":"mark as read",onClick:()=>u(o.id),size:"small",children:a.jsx(Y,{})}),a.jsx(J,{edge:"end","aria-label":"delete",onClick:()=>h(o.id),size:"small",color:"error",children:a.jsx(Pr,{})})]})})]}),s<e.length-1&&a.jsx(Rr,{})]},o.id))})}):a.jsx(w,{children:a.jsx(Br,{children:a.jsxs(m,{textAlign:"center",py:4,children:[a.jsx(I,{sx:{fontSize:64,color:"text.disabled",mb:2}}),a.jsx(f,{variant:"h6",color:"text.secondary",children:"No notifications to display"}),a.jsx(f,{variant:"body2",color:"text.disabled",mt:1,children:"You're all caught up! New notifications will appear here."})]})})})]})})};export{Er as default};
