import{r as x,d as Ie,g as Me,u as we,_ as Te,b3 as ls,e as M,b4 as cs,b5 as ds,j as e,s as oe,f as ve,h as We,P as ae,b6 as xs,i as g,a as b,b0 as us,b1 as ms,Q as hs,ao as X,a3 as ps,B as i,T as n,c as Xe,Y as fs,ag as js,ar as _e,G as h,F as Z,aE as gs,aF as ee,b as Ce,I as z,H as bs,aG as Ze,aH as $e,aI as es,aJ as De,aj as de,ak as xe,al as ue,am as I,a7 as a,an as me,E as he,J as G}from"./index-CVowLR_r.js";import{d as ss,a as se,b as te}from"./Person-Du1814h0.js";import{d as F}from"./CalendarToday-DJ0dY9a5.js";const ns=x.createContext({});function vs(r){return Me("MuiAccordion",r)}const pe=Ie("MuiAccordion",["root","rounded","expanded","disabled","gutters","region"]),ys=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","slots","slotProps","TransitionComponent","TransitionProps"],Ss=r=>{const{classes:o,square:c,expanded:d,disabled:p,disableGutters:S}=r;return We({root:["root",!c&&"rounded",d&&"expanded",p&&"disabled",!S&&"gutters"],region:["region"]},vs,o)},As=oe(ae,{name:"MuiAccordion",slot:"Root",overridesResolver:(r,o)=>{const{ownerState:c}=r;return[{[`& .${pe.region}`]:o.region},o.root,!c.square&&o.rounded,!c.disableGutters&&o.gutters]}})(({theme:r})=>{const o={duration:r.transitions.duration.shortest};return{position:"relative",transition:r.transitions.create(["margin"],o),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(r.vars||r).palette.divider,transition:r.transitions.create(["opacity","background-color"],o)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${pe.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${pe.disabled}`]:{backgroundColor:(r.vars||r).palette.action.disabledBackground}}},({theme:r})=>({variants:[{props:o=>!o.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(r.vars||r).shape.borderRadius,borderTopRightRadius:(r.vars||r).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(r.vars||r).shape.borderRadius,borderBottomRightRadius:(r.vars||r).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:o=>!o.disableGutters,style:{[`&.${pe.expanded}`]:{margin:"16px 0"}}}]})),ts=x.forwardRef(function(o,c){const d=we({props:o,name:"MuiAccordion"}),{children:p,className:S,defaultExpanded:A=!1,disabled:R=!1,disableGutters:_=!1,expanded:J,onChange:C,square:N=!1,slots:P={},slotProps:B={},TransitionComponent:w,TransitionProps:$}=d,v=Te(d,ys),[j,ie]=ls({controlled:J,default:A,name:"Accordion",state:"expanded"}),K=x.useCallback(u=>{ie(!j),C&&C(u,!j)},[j,C,ie]),[L,...le]=x.Children.toArray(p),Q=x.useMemo(()=>({expanded:j,disabled:R,disableGutters:_,toggle:K}),[j,R,_,K]),T=M({},d,{square:N,disabled:R,disableGutters:_,expanded:j}),k=Ss(T),H=M({transition:w},P),y=M({transition:$},B),[ce,ye]=cs("transition",{elementType:ds,externalForwardedProps:{slots:H,slotProps:y},ownerState:T});return e.jsxs(As,M({className:ve(k.root,S),ref:c,ownerState:T,square:N},v,{children:[e.jsx(ns.Provider,{value:Q,children:L}),e.jsx(ce,M({in:j,timeout:"auto"},ye,{children:e.jsx("div",{"aria-labelledby":L.props.id,id:L.props["aria-controls"],role:"region",className:k.region,children:le})}))]}))});function Rs(r){return Me("MuiAccordionDetails",r)}Ie("MuiAccordionDetails",["root"]);const _s=["className"],Cs=r=>{const{classes:o}=r;return We({root:["root"]},Rs,o)},$s=oe("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(r,o)=>o.root})(({theme:r})=>({padding:r.spacing(1,2,2)})),rs=x.forwardRef(function(o,c){const d=we({props:o,name:"MuiAccordionDetails"}),{className:p}=d,S=Te(d,_s),A=d,R=Cs(A);return e.jsx($s,M({className:ve(R.root,p),ref:c,ownerState:A},S))});function Ds(r){return Me("MuiAccordionSummary",r)}const Y=Ie("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),zs=["children","className","expandIcon","focusVisibleClassName","onClick"],Ps=r=>{const{classes:o,expanded:c,disabled:d,disableGutters:p}=r;return We({root:["root",c&&"expanded",d&&"disabled",!p&&"gutters"],focusVisible:["focusVisible"],content:["content",c&&"expanded",!p&&"contentGutters"],expandIconWrapper:["expandIconWrapper",c&&"expanded"]},Ds,o)},ks=oe(xs,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(r,o)=>o.root})(({theme:r})=>{const o={duration:r.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:r.spacing(0,2),transition:r.transitions.create(["min-height","background-color"],o),[`&.${Y.focusVisible}`]:{backgroundColor:(r.vars||r).palette.action.focus},[`&.${Y.disabled}`]:{opacity:(r.vars||r).palette.action.disabledOpacity},[`&:hover:not(.${Y.disabled})`]:{cursor:"pointer"},variants:[{props:c=>!c.disableGutters,style:{[`&.${Y.expanded}`]:{minHeight:64}}}]}}),Is=oe("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(r,o)=>o.content})(({theme:r})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:o=>!o.disableGutters,style:{transition:r.transitions.create(["margin"],{duration:r.transitions.duration.shortest}),[`&.${Y.expanded}`]:{margin:"20px 0"}}}]})),Ms=oe("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(r,o)=>o.expandIconWrapper})(({theme:r})=>({display:"flex",color:(r.vars||r).palette.action.active,transform:"rotate(0deg)",transition:r.transitions.create("transform",{duration:r.transitions.duration.shortest}),[`&.${Y.expanded}`]:{transform:"rotate(180deg)"}})),as=x.forwardRef(function(o,c){const d=we({props:o,name:"MuiAccordionSummary"}),{children:p,className:S,expandIcon:A,focusVisibleClassName:R,onClick:_}=d,J=Te(d,zs),{disabled:C=!1,disableGutters:N,expanded:P,toggle:B}=x.useContext(ns),w=j=>{B&&B(j),_&&_(j)},$=M({},d,{expanded:P,disabled:C,disableGutters:N}),v=Ps($);return e.jsxs(ks,M({focusRipple:!1,disableRipple:!0,disabled:C,component:"div","aria-expanded":P,className:ve(v.root,S),focusVisibleClassName:ve(v.focusVisible,R),onClick:w,ref:c,ownerState:$},J,{children:[e.jsx(Is,{className:v.content,ownerState:$,children:p}),A&&e.jsx(Ms,{className:v.expandIconWrapper,ownerState:$,children:A})]}))});var Ee={},ws=g;Object.defineProperty(Ee,"__esModule",{value:!0});var fe=Ee.default=void 0,Ts=ws(b()),Ws=e;fe=Ee.default=(0,Ts.default)((0,Ws.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var Ne={},Es=g;Object.defineProperty(Ne,"__esModule",{value:!0});var je=Ne.default=void 0,Ns=Es(b()),Bs=e;je=Ne.default=(0,Ns.default)((0,Bs.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");var Be={},Ls=g;Object.defineProperty(Be,"__esModule",{value:!0});var ge=Be.default=void 0,Hs=Ls(b()),Vs=e;ge=Be.default=(0,Hs.default)((0,Vs.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel");var Le={},qs=g;Object.defineProperty(Le,"__esModule",{value:!0});var ze=Le.default=void 0,Gs=qs(b()),Fs=e;ze=Le.default=(0,Gs.default)((0,Fs.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone");var He={},Os=g;Object.defineProperty(He,"__esModule",{value:!0});var Pe=He.default=void 0,Us=Os(b()),Ys=e;Pe=He.default=(0,Us.default)((0,Ys.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email");var Ve={},Js=g;Object.defineProperty(Ve,"__esModule",{value:!0});var be=Ve.default=void 0,Ks=Js(b()),Qs=e;be=Ve.default=(0,Ks.default)((0,Qs.jsx)("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"}),"AccountBalance");var qe={},Xs=g;Object.defineProperty(qe,"__esModule",{value:!0});var E=qe.default=void 0,Zs=Xs(b()),et=e;E=qe.default=(0,Zs.default)((0,et.jsx)("path",{d:"M18 17H6v-2h12zm0-4H6v-2h12zm0-4H6V7h12zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2z"}),"Receipt");var Ge={},st=g;Object.defineProperty(Ge,"__esModule",{value:!0});var O=Ge.default=void 0,tt=st(b()),rt=e;O=Ge.default=(0,tt.default)((0,rt.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"}),"CreditCard");var Fe={},at=g;Object.defineProperty(Fe,"__esModule",{value:!0});var U=Fe.default=void 0,nt=at(b()),ot=e;U=Fe.default=(0,nt.default)((0,ot.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"}),"Payment");var Oe={},it=g;Object.defineProperty(Oe,"__esModule",{value:!0});var os=Oe.default=void 0,lt=it(b()),ct=e;os=Oe.default=(0,lt.default)((0,ct.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment");var Ue={},dt=g;Object.defineProperty(Ue,"__esModule",{value:!0});var ke=Ue.default=void 0,xt=dt(b()),ut=e;ke=Ue.default=(0,xt.default)((0,ut.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var Ye={},mt=g;Object.defineProperty(Ye,"__esModule",{value:!0});var is=Ye.default=void 0,ht=mt(b()),pt=e;is=Ye.default=(0,ht.default)((0,pt.jsx)("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2M1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2"}),"ShoppingCart");var Je={},ft=g;Object.defineProperty(Je,"__esModule",{value:!0});var ne=Je.default=void 0,jt=ft(b()),gt=e;ne=Je.default=(0,jt.default)((0,gt.jsx)("path",{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42M5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7"}),"LocalOffer");function re({children:r,value:o,index:c,...d}){return e.jsx("div",{role:"tabpanel",hidden:o!==c,id:`customer-tabpanel-${c}`,"aria-labelledby":`customer-tab-${c}`,...d,children:o===c&&e.jsx(i,{sx:{p:3},children:r})})}const St=()=>{var Qe;const{id:r}=us(),o=ms(),c=hs(),d=(Qe=o.state)==null?void 0:Qe.customer,[p,S]=x.useState(0),[A,R]=x.useState(null),[_,J]=x.useState([]),[C,N]=x.useState([]),[P,B]=x.useState([]),[w,$]=x.useState([]),[v,j]=x.useState({totalDiscounts:0,discountCount:0}),[ie,K]=x.useState(!0),[L,le]=x.useState(null),[Q,T]=x.useState(null),[k,H]=x.useState({}),y=r||(d==null?void 0:d.id);x.useEffect(()=>{y&&ce()},[y]);const ce=async()=>{try{K(!0);const[s,l,f,W]=await Promise.all([fetch(`${X}/api/customers/${y}/summary`),fetch(`${X}/api/customers/${y}/receipts`),fetch(`${X}/api/customers/${y}/debts`),fetch(`${X}/api/customers/${y}/payments`)]);if(s.ok){const m=await s.json();R(m.customer)}if(l.ok){const m=await l.json();J(m.receipts||[])}if(f.ok){const m=await f.json();N(m.debts||[])}if(W.ok){const m=await W.json();B(m.payments||[])}try{const m=await ps.fetchCustomerDiscounts(y);$(m.discounts||[]),j({totalDiscounts:m.totalDiscounts||0,discountCount:m.discountCount||0})}catch(m){console.error("Error fetching discounts:",m),$([]),j({totalDiscounts:0,discountCount:0})}}catch(s){le("Failed to fetch customer data"),console.error("Error fetching customer data:",s)}finally{K(!1)}},ye=(s,l)=>{S(l)},u=s=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(s||0),D=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Se=(s,l)=>{T(s),H({[s]:l})},V=()=>{T(null),H({})},q=async s=>{try{let l=k[s];s==="phone"&&(l=k[s].split(",").map(m=>m.trim()).filter(m=>m.length>0));const f={name:t.name,company:t.company,address:t.address,[s]:l};if((await fetch(`${X}/api/customers/${y}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)})).ok)R(m=>({...m,[s]:l})),T(null),H({}),ce();else throw new Error("Failed to update customer")}catch(l){console.error("Error updating customer:",l),le("Failed to update customer information")}},Ae=(s,l)=>{H(f=>({...f,[s]:l}))};if(!y)return e.jsx(i,{sx:{p:{xs:1.5,sm:2},maxWidth:"100%"},children:e.jsxs(ae,{elevation:0,sx:{p:{xs:1.5,sm:2},backgroundColor:"#f8f9fa",maxWidth:"100%"},children:[e.jsx(n,{variant:"h6",color:"error",children:"Customer not found. Please go back and try again."}),e.jsx(Xe,{startIcon:e.jsx(ss,{}),onClick:()=>c("/customers"),sx:{mt:2},children:"Back to Customers"})]})});if(ie)return e.jsx(i,{sx:{p:{xs:1.5,sm:2},maxWidth:"100%",display:"flex",justifyContent:"center"},children:e.jsx(fs,{})});if(L)return e.jsx(i,{sx:{p:{xs:1.5,sm:2},maxWidth:"100%"},children:e.jsx(js,{severity:"error",children:L})});const t=A||d,Re=Array.isArray(t==null?void 0:t.phone)?t.phone:[t==null?void 0:t.phone].filter(Boolean),Ke=Array.isArray(t==null?void 0:t.email)?t.email:[t==null?void 0:t.email].filter(Boolean);return e.jsxs(i,{sx:{p:{xs:.5,sm:2},pb:{xs:3,sm:4},maxWidth:"100%",height:"100vh",overflow:"auto"},children:[e.jsxs(ae,{elevation:0,sx:{p:{xs:1.5,sm:2},mb:3,backgroundColor:"#f8f9fa",maxWidth:"100%"},children:[e.jsx(Xe,{startIcon:e.jsx(ss,{}),onClick:()=>c("/customers"),variant:"outlined",sx:{mb:2,borderRadius:"8px",textTransform:"none",fontWeight:600},children:"Back to Customers"}),e.jsxs(n,{variant:"h4",gutterBottom:!0,sx:{fontWeight:600,color:"#1a237e",mb:2,fontSize:{xs:"1.25rem",sm:"1.75rem"}},children:[_e(t==null?void 0:t.company)," ",_e(t==null?void 0:t.name)," - Customer Details"]})]}),e.jsxs(ae,{elevation:0,sx:{p:{xs:1.5,sm:2},mb:3,backgroundColor:"#f8f9fa",maxWidth:"100%"},children:[e.jsx(n,{variant:"h5",sx:{fontWeight:600,color:"#1a237e",mb:2,fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:"Customer Summary"}),e.jsxs(h,{container:!0,spacing:{xs:1,sm:1.5},children:[e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Z,{elevation:2,sx:{p:{xs:1.5,sm:2},textAlign:"center",backgroundColor:"#ffffff",borderRadius:"8px",transition:"transform 0.2s",height:"100%",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-3px)",boxShadow:2}},children:[e.jsx(i,{sx:{backgroundColor:"#e3f2fd",borderRadius:"50%",width:{xs:40,sm:45},height:{xs:40,sm:45},display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 8px"},children:e.jsx(os,{color:"primary",sx:{fontSize:{xs:20,sm:24}}})}),e.jsx(n,{variant:"h6",sx:{color:"#666",mb:.5,fontWeight:500,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:"Total Purchases"}),e.jsx(n,{variant:"h4",sx:{fontWeight:700,color:"#1976d2",fontSize:{xs:"1.25rem",sm:"1.5rem"}},children:u(t==null?void 0:t.totalPurchases)}),e.jsxs(n,{variant:"body2",sx:{color:"#666",fontWeight:500},children:[(t==null?void 0:t.totalReceipts)||0," receipts"]})]})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Z,{elevation:2,sx:{p:{xs:1.5,sm:2},textAlign:"center",backgroundColor:"#ffffff",borderRadius:"8px",transition:"transform 0.2s",height:"100%",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-3px)",boxShadow:2}},children:[e.jsx(i,{sx:{backgroundColor:"#e8f5e9",borderRadius:"50%",width:{xs:40,sm:45},height:{xs:40,sm:45},display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 8px"},children:e.jsx(se,{color:"success",sx:{fontSize:{xs:20,sm:24}}})}),e.jsx(n,{variant:"h6",sx:{color:"#666",mb:.5,fontWeight:500,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:"Total Paid"}),e.jsx(n,{variant:"h4",sx:{fontWeight:700,color:"#2e7d32",fontSize:{xs:"1.25rem",sm:"1.5rem"}},children:u(t==null?void 0:t.totalPaid)}),e.jsx(n,{variant:"body2",sx:{color:"#666",fontWeight:500},children:"Payments received"})]})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Z,{elevation:2,sx:{p:{xs:1.5,sm:2},textAlign:"center",backgroundColor:"#ffffff",borderRadius:"8px",transition:"transform 0.2s",height:"100%",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-3px)",boxShadow:2}},children:[e.jsx(i,{sx:{backgroundColor:"#ffebee",borderRadius:"50%",width:{xs:40,sm:45},height:{xs:40,sm:45},display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 8px"},children:e.jsx(O,{color:"error",sx:{fontSize:{xs:20,sm:24}}})}),e.jsx(n,{variant:"h6",sx:{color:"#666",mb:.5,fontWeight:500,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:"Outstanding Debt"}),e.jsx(n,{variant:"h4",sx:{fontWeight:700,color:"#d32f2f",fontSize:{xs:"1.25rem",sm:"1.5rem"}},children:u(t==null?void 0:t.totalDebt)}),e.jsxs(n,{variant:"body2",sx:{color:"#666",fontWeight:500},children:[(t==null?void 0:t.pendingDebts)||0," pending debts"]})]})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Z,{elevation:2,sx:{p:{xs:1.5,sm:2},textAlign:"center",backgroundColor:"#ffffff",borderRadius:"8px",transition:"transform 0.2s",height:"100%",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-3px)",boxShadow:2}},children:[e.jsx(i,{sx:{backgroundColor:"#fff3e0",borderRadius:"50%",width:{xs:40,sm:45},height:{xs:40,sm:45},display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 8px"},children:e.jsx(ne,{color:"warning",sx:{fontSize:{xs:20,sm:24}}})}),e.jsx(n,{variant:"h6",sx:{color:"#666",mb:.5,fontWeight:500,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:"Total Discounts"}),e.jsx(n,{variant:"h4",sx:{fontWeight:700,color:"#f57c00",fontSize:{xs:"1.25rem",sm:"1.5rem"}},children:u(v.totalDiscounts)}),e.jsxs(n,{variant:"body2",sx:{color:"#666",fontWeight:500},children:[v.discountCount," discount transactions"]})]})})]})]}),e.jsxs(ae,{elevation:0,sx:{p:{xs:1.5,sm:2},backgroundColor:"#f8f9fa",maxWidth:"100%"},children:[e.jsx(i,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(gs,{value:p,onChange:ye,"aria-label":"customer info tabs",sx:{"& .MuiTab-root":{textTransform:"none",fontWeight:500,fontSize:"0.9rem",minHeight:"48px",color:"#666","&.Mui-selected":{color:"#1976d2",fontWeight:600}},"& .MuiTabs-indicator":{backgroundColor:"#1976d2"}},children:[e.jsx(ee,{icon:e.jsx(te,{}),label:"Basic Info",id:"customer-tab-0","aria-controls":"customer-tabpanel-0"}),e.jsx(ee,{icon:e.jsx(E,{}),label:`Receipts (${_.length})`,id:"customer-tab-1","aria-controls":"customer-tabpanel-1"}),e.jsx(ee,{icon:e.jsx(O,{}),label:`Debts (${C.length})`,id:"customer-tab-2","aria-controls":"customer-tabpanel-2"}),e.jsx(ee,{icon:e.jsx(U,{}),label:`Payments (${P.length})`,id:"customer-tab-3","aria-controls":"customer-tabpanel-3"}),e.jsx(ee,{icon:e.jsx(ne,{}),label:`Discounts (${w.length})`,id:"customer-tab-4","aria-controls":"customer-tabpanel-4"})]})}),e.jsx(re,{value:p,index:0,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,md:8,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsxs(h,{item:!0,xs:12,sm:6,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Full Name"}),Q==="name"?e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(Ce,{size:"small",value:k.name||"",onChange:s=>Ae("name",s.target.value),onKeyPress:s=>{s.key==="Enter"?q("name"):s.key==="Escape"&&V()},autoFocus:!0}),e.jsx(z,{size:"small",onClick:()=>q("name"),color:"primary",children:e.jsx(je,{fontSize:"small"})}),e.jsx(z,{size:"small",onClick:V,color:"secondary",children:e.jsx(ge,{fontSize:"small"})})]}):e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(n,{variant:"body1",sx:{flexGrow:1},children:_e(t==null?void 0:t.name)}),e.jsx(z,{size:"small",onClick:()=>Se("name",t==null?void 0:t.name),sx:{opacity:.7,"&:hover":{opacity:1}},children:e.jsx(fe,{fontSize:"small"})})]})]}),e.jsxs(h,{item:!0,xs:12,sm:6,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Customer ID"}),e.jsxs(n,{variant:"body1",sx:{mb:2},children:["#",t==null?void 0:t.id]})]}),e.jsxs(h,{item:!0,xs:12,sm:6,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Company"}),Q==="company"?e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(Ce,{size:"small",value:k.company||"",onChange:s=>Ae("company",s.target.value),onKeyPress:s=>{s.key==="Enter"?q("company"):s.key==="Escape"&&V()},autoFocus:!0}),e.jsx(z,{size:"small",onClick:()=>q("company"),color:"primary",children:e.jsx(je,{fontSize:"small"})}),e.jsx(z,{size:"small",onClick:V,color:"secondary",children:e.jsx(ge,{fontSize:"small"})})]}):e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(n,{variant:"body1",sx:{flexGrow:1},children:(t==null?void 0:t.company)||"Individual Customer"}),e.jsx(z,{size:"small",onClick:()=>Se("company",(t==null?void 0:t.company)||""),sx:{opacity:.7,"&:hover":{opacity:1}},children:e.jsx(fe,{fontSize:"small"})})]})]}),e.jsxs(h,{item:!0,xs:12,sm:6,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Loyalty Points"}),e.jsx(n,{variant:"body1",sx:{mb:2},children:(t==null?void 0:t.loyaltyPoints)||0})]}),(t==null?void 0:t.address)&&e.jsxs(h,{item:!0,xs:12,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Address"}),e.jsx(n,{variant:"body1",sx:{mb:2},children:t.address})]}),(t==null?void 0:t.notes)&&e.jsxs(h,{item:!0,xs:12,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Notes"}),e.jsx(n,{variant:"body1",children:t.notes})]})]})}),e.jsx(h,{item:!0,xs:12,md:4,children:e.jsx(Z,{elevation:2,sx:{p:{xs:1.5,sm:2},backgroundColor:"#ffffff",borderRadius:"8px",transition:"transform 0.2s",height:"100%",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-3px)",boxShadow:2}},children:e.jsxs(bs,{children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(te,{color:"primary",sx:{mr:1}}),e.jsx(n,{variant:"h6",children:"Contact Information"})]}),e.jsxs(i,{sx:{mb:2},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",mb:1,justifyContent:"space-between"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ze,{fontSize:"small",color:"primary",sx:{mr:1}}),e.jsx(n,{variant:"subtitle2",color:"text.secondary",children:"Phone Numbers"})]}),e.jsx(z,{size:"small",onClick:()=>Se("phone",Re.join(", ")),sx:{opacity:.7,"&:hover":{opacity:1}},children:e.jsx(fe,{fontSize:"small"})})]}),Q==="phone"?e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ce,{size:"small",fullWidth:!0,value:k.phone||"",onChange:s=>Ae("phone",s.target.value),onKeyPress:s=>{s.key==="Enter"?q("phone"):s.key==="Escape"&&V()},placeholder:"Enter phone numbers separated by commas",autoFocus:!0}),e.jsx(z,{size:"small",onClick:()=>q("phone"),color:"primary",children:e.jsx(je,{fontSize:"small"})}),e.jsx(z,{size:"small",onClick:V,color:"secondary",children:e.jsx(ge,{fontSize:"small"})})]}):e.jsx(Ze,{dense:!0,children:Re.length>0?Re.map((s,l)=>e.jsxs($e,{sx:{px:0},children:[e.jsx(es,{sx:{minWidth:32},children:e.jsx(ze,{fontSize:"small",color:"primary"})}),e.jsx(De,{primary:s})]},l)):e.jsx($e,{sx:{px:0},children:e.jsx(De,{primary:"No phone numbers",sx:{color:"text.secondary",fontStyle:"italic"}})})})]}),Ke.length>0&&e.jsxs(i,{children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Pe,{fontSize:"small",color:"primary",sx:{mr:1}}),e.jsx(n,{variant:"subtitle2",color:"text.secondary",children:"Email Addresses"})]}),e.jsx(Ze,{dense:!0,children:Ke.map((s,l)=>e.jsxs($e,{sx:{px:0},children:[e.jsx(es,{sx:{minWidth:32},children:e.jsx(Pe,{fontSize:"small",color:"primary"})}),e.jsx(De,{primary:s})]},l))})]})]})})}),e.jsxs(h,{item:!0,xs:12,sm:6,md:3,children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(F,{color:"info",sx:{mr:1}}),e.jsx(n,{variant:"h6",children:"Last Purchase"})]}),e.jsx(n,{variant:"body1",color:"info.main",children:t!=null&&t.lastPurchaseDate?D(t.lastPurchaseDate):"No purchases yet"})]})]})}),e.jsx(re,{value:p,index:1,children:_.length>0?e.jsx(de,{sx:{boxShadow:"0 12px 40px rgba(102, 126, 234, 0.15), 0 4px 16px rgba(0, 0, 0, 0.08)",borderRadius:"20px",border:"2px solid transparent",background:"linear-gradient(white, white) padding-box, linear-gradient(135deg, #667eea, #764ba2, #f093fb) border-box",overflow:"hidden",position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, rgba(102, 126, 234, 0.02) 0%, rgba(118, 75, 162, 0.02) 100%)",pointerEvents:"none"}},children:e.jsxs(xe,{sx:{"& .MuiTableHead-root":{background:"linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%)",position:"relative","&::after":{content:'""',position:"absolute",bottom:0,left:0,right:0,height:"3px",background:"linear-gradient(90deg, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0.6) 50%, rgba(255, 255, 255, 0.3) 100%)"}},"& .MuiTableHead-root .MuiTableCell-root":{color:"white",fontWeight:700,fontSize:"1.1rem",padding:"24px 20px",borderBottom:"none",textShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",position:"relative"},"& .MuiTableBody-root .MuiTableCell-root":{padding:"20px",borderBottom:"1px solid rgba(102, 126, 234, 0.08)",fontSize:"0.95rem",transition:"all 0.3s ease"}},children:[e.jsx(ue,{children:e.jsxs(I,{children:[e.jsxs(a,{children:[e.jsx(E,{sx:{mr:1,verticalAlign:"middle"}}),"Receipt ID"]}),e.jsxs(a,{children:[e.jsx(F,{sx:{mr:1,verticalAlign:"middle"}}),"Date"]}),e.jsxs(a,{children:[e.jsx(se,{sx:{mr:1,verticalAlign:"middle"}}),"Total"]}),e.jsxs(a,{children:[e.jsx(U,{sx:{mr:1,verticalAlign:"middle"}}),"Amount Paid"]}),e.jsxs(a,{children:[e.jsx(be,{sx:{mr:1,verticalAlign:"middle"}}),"Balance"]}),e.jsxs(a,{children:[e.jsx(te,{sx:{mr:1,verticalAlign:"middle"}}),"Served By"]}),e.jsx(a,{children:"Status"}),e.jsxs(a,{children:[e.jsx(is,{sx:{mr:1,verticalAlign:"middle"}}),"Items"]})]})}),e.jsx(me,{children:_.map((s,l)=>e.jsxs(he.tr,{component:I,initial:{opacity:0,x:-30,scale:.95},animate:{opacity:1,x:0,scale:1},transition:{duration:.4,delay:l*.08,type:"spring",stiffness:100},sx:{backgroundColor:s.flagged?"rgba(239, 68, 68, 0.05)":"inherit",transition:"all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)",borderRadius:"12px",margin:"4px 0",cursor:"pointer","&:hover":{backgroundColor:s.flagged?"rgba(239, 68, 68, 0.1)":"rgba(102, 126, 234, 0.06)",transform:"translateX(12px) scale(1.01)",boxShadow:"0 8px 25px rgba(102, 126, 234, 0.2), 0 4px 12px rgba(0, 0, 0, 0.1)","& .MuiTableCell-root":{color:"#667eea",fontWeight:600}}},children:[e.jsxs(a,{children:["#",s.id]}),e.jsx(a,{children:D(s.createdAt)}),e.jsx(a,{children:u(s.total)}),e.jsx(a,{children:u(s.amountPaid)}),e.jsx(a,{children:e.jsx(G,{label:u(s.balance),color:s.balance>0?"error":"success",size:"small"})}),e.jsx(a,{children:s.workerName||"N/A"}),e.jsx(a,{children:e.jsx(G,{label:s.flagged?"Flagged":"Active",color:s.flagged?"error":"success",size:"small",icon:s.flagged?e.jsx("span",{children:"ðŸš©"}):e.jsx("span",{children:"âœ“"})})}),e.jsx(a,{children:s.items.length>0&&e.jsxs(ts,{children:[e.jsx(as,{expandIcon:e.jsx(ke,{}),children:e.jsxs(n,{variant:"body2",children:[s.items.length," items"]})}),e.jsx(rs,{children:s.items.map((f,W)=>e.jsx(i,{sx:{mb:1},children:e.jsxs(n,{variant:"body2",children:[f.name," - Qty: ",f.quantity," @"," ",u(f.salesPrice)]})},W))})]})})]},s.id))})]})}):e.jsxs(i,{sx:{textAlign:"center",py:4},children:[e.jsx(E,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"No receipts found"})]})}),e.jsx(re,{value:p,index:2,children:C.length>0?e.jsx(de,{children:e.jsxs(xe,{children:[e.jsx(ue,{children:e.jsxs(I,{children:[e.jsxs(a,{children:[e.jsx(O,{sx:{mr:1,verticalAlign:"middle"}}),"Debt ID"]}),e.jsxs(a,{children:[e.jsx(F,{sx:{mr:1,verticalAlign:"middle"}}),"Created"]}),e.jsxs(a,{children:[e.jsx(se,{sx:{mr:1,verticalAlign:"middle"}}),"Amount"]}),e.jsxs(a,{children:[e.jsx(be,{sx:{mr:1,verticalAlign:"middle"}}),"Status"]}),e.jsxs(a,{children:[e.jsx(F,{sx:{mr:1,verticalAlign:"middle"}}),"Due Date"]}),e.jsxs(a,{children:[e.jsx(E,{sx:{mr:1,verticalAlign:"middle"}}),"Related Receipt"]}),e.jsxs(a,{children:[e.jsx(U,{sx:{mr:1,verticalAlign:"middle"}}),"Payments"]})]})}),e.jsx(me,{children:C.map((s,l)=>e.jsxs(he.tr,{component:I,initial:{opacity:0,x:-30,scale:.95},animate:{opacity:1,x:0,scale:1},transition:{duration:.4,delay:l*.08,type:"spring",stiffness:100},sx:{transition:"all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)",borderRadius:"12px",margin:"4px 0",cursor:"pointer","&:hover":{backgroundColor:"rgba(239, 68, 68, 0.06)",transform:"translateX(12px) scale(1.01)",boxShadow:"0 8px 25px rgba(239, 68, 68, 0.2), 0 4px 12px rgba(0, 0, 0, 0.1)","& .MuiTableCell-root":{color:"#ef4444",fontWeight:600}}},children:[e.jsxs(a,{children:["#",s.id]}),e.jsx(a,{children:D(s.createdAt)}),e.jsx(a,{children:u(s.amount)}),e.jsx(a,{children:e.jsx(G,{label:s.status,color:s.status==="pending"?"error":"success",size:"small"})}),e.jsx(a,{children:s.dueDate?D(s.dueDate):"N/A"}),e.jsx(a,{children:s.receiptId?e.jsxs(i,{children:[e.jsxs(n,{variant:"body2",children:["#",s.receiptId]}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[u(s.receiptTotal)," on"," ",D(s.receiptDate)]})]}):"N/A"}),e.jsx(a,{children:s.payments.length>0&&e.jsxs(ts,{children:[e.jsx(as,{expandIcon:e.jsx(ke,{}),children:e.jsxs(n,{variant:"body2",children:[s.payments.length," payments"]})}),e.jsx(rs,{children:s.payments.map((f,W)=>e.jsxs(i,{sx:{mb:1},children:[e.jsxs(n,{variant:"body2",children:[u(f.amountPaid)," on"," ",D(f.date)]}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[f.paymentMethod," -"," ",f.workerName]})]},W))})]})})]},s.id))})]})}):e.jsxs(i,{sx:{textAlign:"center",py:4},children:[e.jsx(O,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"No debts found"})]})}),e.jsx(re,{value:p,index:3,children:P.length>0?e.jsx(de,{children:e.jsxs(xe,{children:[e.jsx(ue,{children:e.jsxs(I,{children:[e.jsxs(a,{children:[e.jsx(U,{sx:{mr:1,verticalAlign:"middle"}}),"Payment ID"]}),e.jsxs(a,{children:[e.jsx(F,{sx:{mr:1,verticalAlign:"middle"}}),"Date"]}),e.jsxs(a,{children:[e.jsx(se,{sx:{mr:1,verticalAlign:"middle"}}),"Amount"]}),e.jsxs(a,{children:[e.jsx(be,{sx:{mr:1,verticalAlign:"middle"}}),"Method"]}),e.jsxs(a,{children:[e.jsx(te,{sx:{mr:1,verticalAlign:"middle"}}),"Processed By"]}),e.jsxs(a,{children:[e.jsx(O,{sx:{mr:1,verticalAlign:"middle"}}),"Debt Info"]}),e.jsxs(a,{children:[e.jsx(E,{sx:{mr:1,verticalAlign:"middle"}}),"Receipt Info"]})]})}),e.jsx(me,{children:P.map((s,l)=>e.jsxs(he.tr,{component:I,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:l*.05},sx:{transition:"all 0.2s ease","&:hover":{backgroundColor:"rgba(102, 126, 234, 0.08)",transform:"scale(1.01)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"}},children:[e.jsxs(a,{children:["#",s.id]}),e.jsx(a,{children:D(s.date)}),e.jsx(a,{children:u(s.amountPaid)}),e.jsx(a,{children:e.jsx(G,{label:s.paymentMethod,size:"small"})}),e.jsx(a,{children:s.workerName||"N/A"}),e.jsx(a,{children:e.jsxs(i,{children:[e.jsxs(n,{variant:"body2",children:["Debt: ",u(s.debtAmount)]}),e.jsx(G,{label:s.debtStatus,color:s.debtStatus==="pending"?"error":"success",size:"small"})]})}),e.jsx(a,{children:s.receiptTotal&&e.jsxs(i,{children:[e.jsx(n,{variant:"body2",children:u(s.receiptTotal)}),e.jsx(n,{variant:"caption",color:"text.secondary",children:D(s.receiptDate)})]})})]},s.id))})]})}):e.jsxs(i,{sx:{textAlign:"center",py:4},children:[e.jsx(U,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"No payments found"})]})}),e.jsx(re,{value:p,index:4,children:w.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(i,{sx:{mb:3,p:2,bgcolor:"warning.light",borderRadius:1},children:[e.jsx(n,{variant:"h6",color:"warning.dark",gutterBottom:!0,children:"Discount Summary"}),e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Total Discounts Received:"})," ",u(v.totalDiscounts)]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Number of Discount Transactions:"})," ",v.discountCount]})})]})]}),e.jsx(de,{children:e.jsxs(xe,{children:[e.jsx(ue,{children:e.jsxs(I,{children:[e.jsxs(a,{children:[e.jsx(E,{sx:{mr:1,verticalAlign:"middle"}}),"Receipt ID"]}),e.jsxs(a,{children:[e.jsx(F,{sx:{mr:1,verticalAlign:"middle"}}),"Date"]}),e.jsxs(a,{children:[e.jsx(ne,{sx:{mr:1,verticalAlign:"middle"}}),"Discount Amount"]}),e.jsxs(a,{children:[e.jsx(se,{sx:{mr:1,verticalAlign:"middle"}}),"Receipt Total"]}),e.jsxs(a,{children:[e.jsx(te,{sx:{mr:1,verticalAlign:"middle"}}),"Processed By"]}),e.jsx(a,{children:"Discount %"})]})}),e.jsx(me,{children:w.map((s,l)=>{const f=s.total>0?(s.discount/s.total*100).toFixed(1):0;return e.jsxs(he.tr,{component:I,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:l*.05},sx:{transition:"all 0.2s ease","&:hover":{backgroundColor:"rgba(102, 126, 234, 0.08)",transform:"scale(1.01)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"}},children:[e.jsxs(a,{children:["#",s.receiptId]}),e.jsx(a,{children:D(s.createdAt)}),e.jsx(a,{children:e.jsx(n,{variant:"body2",color:"warning.dark",fontWeight:"bold",children:u(s.discount)})}),e.jsx(a,{children:u(s.total)}),e.jsx(a,{children:s.workerName||"N/A"}),e.jsx(a,{children:e.jsx(G,{label:`${f}%`,color:"warning",size:"small"})})]},s.receiptId)})})]})})]}):e.jsxs(i,{sx:{textAlign:"center",py:4},children:[e.jsx(ne,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"No discounts found"}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This customer has not received any discounts yet."})]})})]})]})};export{St as default};
