import{d as Je,g as er,r as f,u as rr,_ as tr,e as V,j as e,s as Se,f as We,m as fe,h as sr,b6 as or,n as nr,i as xe,a as be,y as ve,b9 as Re,ba as $e,bb as Ae,aO as ir,bc as we,c as _,b as ar,U as je,bt as Te,R as Be,bh as De,E as Fe,P as me,z as D,T as Q,ax as Ce,G as d,ah as le,ai as ce,ab as de,q as I,bu as Ue,S as lr,bi as cr,I as he,B as N,a3 as U,$ as L,ag as Qe,aC as B,bn as M,br as ge,Q as dr,a1 as ur,a0 as H,bv as mr,aj as hr,ak as pr,al as xr,am as Ve,an as br,bk as fr,a7 as ye,ar as vr,bj as jr,bm as Cr,bl as qe}from"./index-CVowLR_r.js";import{g as Me,F as Le,a as Ze,b as g,c as Ie}from"./formik.esm-DMAcCuh3.js";import{I as pe}from"./InputAdornment-vzh5SJ0Z.js";import{L as Ge}from"./LinearProgress-CkR9Hjqq.js";import{S as Xe}from"./Snackbar-Cz1MwB4l.js";import{u as ue}from"./useMutation-FIspEjot.js";import{S as gr}from"./SearchField-7UroPVKX.js";function yr(r){return er("MuiFab",r)}const Ne=Je("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),Pr=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],kr=r=>{const{color:t,variant:s,classes:n,size:c}=r,u={root:["root",s,`size${fe(c)}`,t==="inherit"?"colorInherit":t]},S=sr(u,yr,n);return V({},n,S)},Sr=Se(or,{name:"MuiFab",slot:"Root",shouldForwardProp:r=>nr(r)||r==="classes",overridesResolver:(r,t)=>{const{ownerState:s}=r;return[t.root,t[s.variant],t[`size${fe(s.size)}`],s.color==="inherit"&&t.colorInherit,t[fe(s.size)],t[s.color]]}})(({theme:r,ownerState:t})=>{var s,n;return V({},r.typography.button,{minHeight:36,transition:r.transitions.create(["background-color","box-shadow","border-color"],{duration:r.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(r.vars||r).zIndex.fab,boxShadow:(r.vars||r).shadows[6],"&:active":{boxShadow:(r.vars||r).shadows[12]},color:r.vars?r.vars.palette.text.primary:(s=(n=r.palette).getContrastText)==null?void 0:s.call(n,r.palette.grey[300]),backgroundColor:(r.vars||r).palette.grey[300],"&:hover":{backgroundColor:(r.vars||r).palette.grey.A100,"@media (hover: none)":{backgroundColor:(r.vars||r).palette.grey[300]},textDecoration:"none"},[`&.${Ne.focusVisible}`]:{boxShadow:(r.vars||r).shadows[6]}},t.size==="small"&&{width:40,height:40},t.size==="medium"&&{width:48,height:48},t.variant==="extended"&&{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},t.variant==="extended"&&t.size==="small"&&{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34},t.variant==="extended"&&t.size==="medium"&&{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40},t.color==="inherit"&&{color:"inherit"})},({theme:r,ownerState:t})=>V({},t.color!=="inherit"&&t.color!=="default"&&(r.vars||r).palette[t.color]!=null&&{color:(r.vars||r).palette[t.color].contrastText,backgroundColor:(r.vars||r).palette[t.color].main,"&:hover":{backgroundColor:(r.vars||r).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(r.vars||r).palette[t.color].main}}}),({theme:r})=>({[`&.${Ne.disabled}`]:{color:(r.vars||r).palette.action.disabled,boxShadow:(r.vars||r).shadows[0],backgroundColor:(r.vars||r).palette.action.disabledBackground}})),Rr=f.forwardRef(function(t,s){const n=rr({props:t,name:"MuiFab"}),{children:c,className:u,color:S="default",component:R="button",disabled:F=!1,disableFocusRipple:A=!1,focusVisibleClassName:w,size:y="large",variant:v="circular"}=n,O=tr(n,Pr),j=V({},n,{color:S,component:R,disabled:F,disableFocusRipple:A,size:y,variant:v}),T=kr(j);return e.jsx(Sr,V({className:We(T.root,u),component:R,disabled:F,focusRipple:!A,focusVisibleClassName:We(T.focusVisible,w),ownerState:j,ref:s},O,{classes:T,children:c}))});var ze={},$r=xe;Object.defineProperty(ze,"__esModule",{value:!0});var Z=ze.default=void 0,Ar=$r(be()),wr=e;Z=ze.default=(0,Ar.default)((0,wr.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");const tt=({children:r,title:t})=>{const[s,n]=f.useState(!1),c=ve("(max-width:600px)"),u=()=>{n(!0)},S=()=>{n(!1)};return e.jsxs("div",{children:[e.jsx(Rr,{color:"primary","aria-label":"add",sx:{bgcolor:"green"},onClick:u,children:e.jsx(Z,{})}),e.jsxs(Re,{open:s,onClose:S,PaperProps:{style:{width:c?"100%":"80%",height:c?"100%":"80%",margin:"auto",maxWidth:"none",maxHeight:"none"}},children:[e.jsx($e,{children:t||"Add New Item"}),e.jsx(Ae,{children:ir.cloneElement(r,{handleClose:S})}),e.jsx(we,{children:e.jsx(_,{onClick:S,children:"Cancel"})})]})]})};var Ee={},Tr=xe;Object.defineProperty(Ee,"__esModule",{value:!0});var Ye=Ee.default=void 0,Br=Tr(be()),Dr=e;Ye=Ee.default=(0,Br.default)((0,Dr.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var G=function(){return G=Object.assign||function(t){for(var s,n=1,c=arguments.length;n<c;n++){s=arguments[n];for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(t[u]=s[u])}return t},G.apply(this,arguments)};function Pe(r,t){var s={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(s[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(r);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(r,n[c])&&(s[n[c]]=r[n[c]]);return s}function Fr(r){var t=r.disabled,s=r.field,n=s.onBlur,c=Pe(s,["onBlur"]),u=r.form,S=u.isSubmitting,R=u.touched,F=u.errors,A=r.onBlur,w=r.helperText,y=Pe(r,["disabled","field","form","onBlur","helperText"]),v=Me(F,c.name),O=Me(R,c.name)&&!!v;return G(G({error:O,helperText:O?v:w,disabled:t??S,onBlur:A??function(j){n(j??c.name)}},c),y)}function k(r){var t=r.children,s=Pe(r,["children"]);return f.createElement(ar,G({},Fr(s)),t)}k.displayName="FormikMaterialUITextField";var _e={},zr=xe;Object.defineProperty(_e,"__esModule",{value:!0});var Ke=_e.default=void 0,Er=zr(be()),_r=e;Ke=_e.default=(0,Er.default)((0,_r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");const Or=Ce().shape({name:B().required("Product name is required").min(2,"Name must be at least 2 characters").max(50,"Name must not exceed 50 characters").matches(/^[a-zA-Z0-9\s-]+$/,"Only letters, numbers, spaces, and hyphens are allowed"),category:B(),baseUnit:B(),unitConversions:ge().of(Ce().shape({fromUnit:B().required("From unit is required"),toUnit:B().required("To unit is required"),conversionRate:M().required("Conversion rate is required").positive("Conversion rate must be positive"),salesPrice:M().required("Unit price is required").positive("Unit price must be positive")})).nullable().default([]),costPrice:M().required("Cost price is required").min(0,"Cost price cannot be negative").max(1e6,"Cost price is too high").typeError("Cost price must be a number"),salesPrice:M().required("Sales price is required").min(0,"Sales price cannot be negative").max(1e6,"Sales price is too high").typeError("Sales price must be a number").test("sales-price","Sales price must be higher than cost price",function(r){return r>this.parent.costPrice}),onhand:M().required("Quantity is required").min(0,"Quantity cannot be negative").max(1e6,"Quantity is too high").typeError("Quantity must be a number"),reorderPoint:M().min(0,"Reorder point cannot be negative").max(1e6,"Reorder point is too high").typeError("Reorder point must be a number"),minimumStock:M().min(0,"Minimum stock cannot be negative").max(1e6,"Minimum stock is too high").typeError("Minimum stock must be a number"),description:B(),sku:B(),barcode:B()}),Wr=({data:r,editMutation:t,onClose:s,onProductUpdate:n})=>{const[c,u]=f.useState(null),[S,R]=f.useState(!1),[F,A]=f.useState(!1),w=je(m=>m.companyState.data.id),{allowedUnits:y,allowedCategories:v}=je(m=>m.companyState),O=s||f.useContext(Te),j=Be(),T=De(),P=r?{...r,unitConversions:r.unitConversions||[]}:{name:"",category:"",baseUnit:"",unitConversions:[],costPrice:"",salesPrice:"",onhand:"",reorderPoint:"",minimumStock:"",description:"",sku:"",barcode:""};return e.jsx(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(me,{elevation:0,sx:{p:3,borderRadius:2,backgroundColor:D("#fff",.8),backdropFilter:"blur(10px)"},children:[e.jsx(Q,{variant:"h5",sx:{mb:4,fontWeight:500,color:"primary.main",textAlign:"center"},children:r?"Edit Product":"Add New Product"}),e.jsx(Le,{initialValues:P,validationSchema:Or,onSubmit:async(m,{setSubmitting:x})=>{m.name=m.name.trim().toLowerCase(),u(null),x(!0);try{let b,$;if(r)b=await U.updateProduct({...m,unitConversions:m.unitConversions||[]});else{const p=await U.addProduct({...m,companyId:w,unitConversions:m.unitConversions||[]});typeof p=="string"?b=p:($=p,j(L.fetchInventorySuccess($)),j(L.addProduct()),R(!0),T.invalidateQueries(["api/products",w]),n&&n($))}b?u(b.message||b.toString()||"An error occurred"):(A(!0),t!=null&&t.mutate&&t.mutate(m),r&&n&&n(m),setTimeout(()=>{O&&O()},2e3))}catch(b){console.error(b),u("An error occurred while saving the product")}finally{x(!1)}},children:({submitForm:m,isSubmitting:x,handleChange:b,resetForm:$,values:p,errors:l,touched:i,setFieldValue:X})=>e.jsx(Ze,{children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{component:k,name:"name",type:"text",label:"Product Name",fullWidth:!0,variant:"outlined",error:i.name&&!!l.name,helperText:i.name&&l.name})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsxs(le,{fullWidth:!0,error:i.category&&!!l.category,children:[e.jsx(ce,{children:"Category"}),e.jsx(g,{as:de,name:"category",label:"Category",variant:"outlined",children:v==null?void 0:v.map(z=>e.jsx(I,{value:z,children:z},z))}),e.jsx(Ue,{children:i.category&&l.category})]})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsxs(le,{fullWidth:!0,error:i.baseUnit&&!!l.baseUnit,children:[e.jsx(ce,{children:"Base Unit"}),e.jsx(g,{as:de,name:"baseUnit",label:"Base Unit",variant:"outlined",children:y==null?void 0:y.map(z=>e.jsx(I,{value:z,children:z},z))}),e.jsx(Ue,{children:i.baseUnit&&l.baseUnit})]})}),p.baseUnit&&e.jsxs(d,{item:!0,xs:12,children:[e.jsx(Q,{variant:"subtitle1",gutterBottom:!0,children:"Unit Conversions"}),e.jsxs(lr,{spacing:2,children:[(p.unitConversions||[]).map((z,C)=>{var Y,K,J,ee,re,W,q,te,se,oe,ne,ie,ae,o,a,h;return e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsxs(le,{fullWidth:!0,children:[e.jsx(ce,{children:"From Unit"}),e.jsx(g,{as:de,name:`unitConversions.${C}.fromUnit`,label:"From Unit",variant:"outlined",children:p.baseUnit&&e.jsx(I,{value:p.baseUnit,children:p.baseUnit},p.baseUnit)})]})}),e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsxs(le,{fullWidth:!0,children:[e.jsx(ce,{children:"To Unit"}),e.jsx(g,{as:de,name:`unitConversions.${C}.toUnit`,label:"To Unit",variant:"outlined",children:y==null?void 0:y.filter(E=>E!==p.baseUnit).map(E=>e.jsx(I,{value:E,children:E},E))})]})}),e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsx(g,{component:k,name:`unitConversions.${C}.conversionRate`,type:"number",label:"Conversion Rate",fullWidth:!0,variant:"outlined",error:((K=(Y=i.unitConversions)==null?void 0:Y[C])==null?void 0:K.conversionRate)&&!!((ee=(J=l.unitConversions)==null?void 0:J[C])!=null&&ee.conversionRate),helperText:((W=(re=i.unitConversions)==null?void 0:re[C])==null?void 0:W.conversionRate)&&((te=(q=l.unitConversions)==null?void 0:q[C])==null?void 0:te.conversionRate)})}),e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsx(g,{component:k,name:`unitConversions.${C}.salesPrice`,type:"number",label:"Unit Price",fullWidth:!0,variant:"outlined",error:((oe=(se=i.unitConversions)==null?void 0:se[C])==null?void 0:oe.salesPricePrice)&&!!((ie=(ne=l.unitConversions)==null?void 0:ne[C])!=null&&ie.salesPrice),helperText:((o=(ae=i.unitConversions)==null?void 0:ae[C])==null?void 0:o.salesrice)&&((h=(a=l.unitConversions)==null?void 0:a[C])==null?void 0:h.salesPrice)})}),e.jsx(d,{item:!0,xs:12,sm:0,children:e.jsx(cr,{title:"Remove Conversion",children:e.jsx(he,{color:"error",onClick:()=>{const E=[...p.unitConversions];E.splice(C,1),X("unitConversions",E)},children:e.jsx(Ke,{})})})})]},C)}),e.jsx(_,{startIcon:e.jsx(Z,{}),onClick:()=>{const z=[...p.unitConversions||[],{fromUnit:"",toUnit:"",conversionRate:"",salesPrice:""}];X("unitConversions",z)},children:"Add Unit Conversion"})]})]}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(g,{component:k,type:"number",label:"Cost Price",name:"costPrice",fullWidth:!0,variant:"outlined",error:i.costPrice&&!!l.costPrice,helperText:i.costPrice&&l.costPrice,InputProps:{startAdornment:e.jsx(pe,{position:"start",children:"₵"})}})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(g,{component:k,type:"number",label:"Sales Price",name:"salesPrice",fullWidth:!0,variant:"outlined",error:i.salesPrice&&!!l.salesPrice,helperText:i.salesPrice&&l.salesPrice,InputProps:{startAdornment:e.jsx(pe,{position:"start",children:"₵"})}})}),e.jsx(d,{item:!0,xs:12,sm:4,children:e.jsx(g,{component:k,type:"number",label:"Quantity on Hand",name:"onhand",fullWidth:!0,variant:"outlined",error:i.onhand&&!!l.onhand,helperText:i.onhand&&l.onhand,disabled:r})}),e.jsx(d,{item:!0,xs:12,sm:4,children:e.jsx(g,{component:k,type:"number",label:"Reorder Point",name:"reorderPoint",fullWidth:!0,variant:"outlined",error:i.reorderPoint&&!!l.reorderPoint,helperText:i.reorderPoint&&l.reorderPoint})}),e.jsx(d,{item:!0,xs:12,sm:4,children:e.jsx(g,{component:k,type:"number",label:"Minimum Stock",name:"minimumStock",fullWidth:!0,variant:"outlined",error:i.minimumStock&&!!l.minimumStock,helperText:i.minimumStock&&l.minimumStock})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(g,{component:k,name:"sku",type:"text",label:"SKU",fullWidth:!0,variant:"outlined",error:i.sku&&!!l.sku,helperText:i.sku&&l.sku})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(g,{component:k,name:"barcode",type:"text",label:"Barcode",fullWidth:!0,variant:"outlined",error:i.barcode&&!!l.barcode,helperText:i.barcode&&l.barcode})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{component:k,name:"description",type:"text",label:"Description",fullWidth:!0,multiline:!0,rows:4,variant:"outlined",error:i.description&&!!l.description,helperText:i.description&&l.description})}),x&&e.jsx(d,{item:!0,xs:12,children:e.jsx(Ge,{sx:{height:6,borderRadius:3}})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(N,{sx:{display:"flex",justifyContent:"center",mt:2},children:S?e.jsx(_,{variant:"contained",color:"primary",size:"large",onClick:()=>{$(),R(!1)},sx:{px:4,py:1.5,borderRadius:2,textTransform:"none",transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:"Product Added! Click to Add New Product"}):e.jsx(_,{variant:"contained",color:"primary",disabled:x||Object.keys(l).length>0,onClick:m,size:"large",sx:{px:4,py:1.5,borderRadius:2,textTransform:"none",transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:r?"Save Changes":"Add Product"})})})]})})}),c&&e.jsx(Qe,{severity:"error",sx:{mt:2,borderRadius:1},children:c}),e.jsx(Xe,{open:F,autoHideDuration:5e3,onClose:()=>A(!1),message:r?"Product Changed Successfully":"Product added successfully",anchorOrigin:{vertical:"top",horizontal:"center"}})]})})},Ur=({children:r,title:t})=>{const[s,n]=f.useState(!1),c=()=>{n(!0)},u=()=>{n(!1)};return e.jsxs("div",{children:[e.jsx(_,{variant:"text",fullWidth:!0,onClick:c,children:"Edit"}),e.jsx(Te.Provider,{value:u,children:e.jsxs(Re,{open:s,onClose:u,PaperProps:{style:{width:"80%",height:"80%",margin:"auto",maxWidth:"none",maxHeight:"none"}},children:[e.jsx($e,{children:t||"Add New Item"}),e.jsx(Ae,{children:r}),e.jsx(we,{children:e.jsx(_,{onClick:u,children:"Cancel"})})]})})]})};var Oe={},qr=xe;Object.defineProperty(Oe,"__esModule",{value:!0});var ke=Oe.default=void 0,Mr=qr(be()),Ir=e;ke=Oe.default=(0,Mr.default)((0,Ir.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove");const Nr=/^(\+?\d{1,3}[- ]?)?\d{10}$/,Hr=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,Qr=Ce().shape({name:B().required("Customer name is required").min(2,"Name must be at least 2 characters").max(50,"Name must not exceed 50 characters").matches(/^[a-zA-Z\s-]+$/,"Only letters, spaces, and hyphens are allowed"),phone:ge().of(B().matches(Nr,"Invalid phone number format")),email:ge().of(B().matches(Hr,"Invalid email format")),address:B().max(200,"Address must not exceed 200 characters"),company:B().max(50,"Company name must not exceed 50 characters").matches(/^[a-zA-Z0-9\s-]+$/,"Only letters, numbers, spaces, and hyphens are allowed")}),Vr=({data:r,editMutation:t})=>{const[s,n]=f.useState(null),[c,u]=f.useState(!1),[S,R]=f.useState(!1),F=je(j=>j.companyState.data.id),A=f.useContext(Te),w=Be(),y=De(),v={name:(r==null?void 0:r.name)||"",phone:Array.isArray(r==null?void 0:r.phone)?r.phone:[(r==null?void 0:r.phone)||""],email:Array.isArray(r==null?void 0:r.email)?r.email:[(r==null?void 0:r.email)||""],address:(r==null?void 0:r.address)||"",company:(r==null?void 0:r.company)||""},O=async(j,{setSubmitting:T})=>{T(!0);try{let P;if(r)j.id=r.id,P=await U.updateCustomer(j);else{const m=await U.addCustomer({...j,companyId:F});typeof m=="string"?P=m:(w(L.addCustomer()),u(!0),y.invalidateQueries(["api/customers",F]))}P?n(P.message||P.toString()||"An error occurred"):(R(!0),t!=null&&t.mutate&&t.mutate(j),setTimeout(A,2e3))}catch(P){console.error(P),n("An error occurred while saving the customer")}finally{T(!1)}};return e.jsx(Fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(me,{elevation:0,sx:{p:3,borderRadius:2,backgroundColor:D("#fff",.8),backdropFilter:"blur(10px)"},children:[e.jsx(Q,{variant:"h5",sx:{mb:4,fontWeight:500,color:"primary.main",textAlign:"center"},children:r?"Edit Customer":"Add New Customer"}),e.jsx(Le,{initialValues:v,validationSchema:Qr,onSubmit:O,children:({submitForm:j,isSubmitting:T,resetForm:P,values:m,errors:x,touched:b})=>e.jsx(Ze,{children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{component:k,name:"name",label:"Customer Name",fullWidth:!0,variant:"outlined",error:b.name&&!!x.name,helperText:b.name&&x.name,onBlur:$=>{const p=$.target.value.trim();$.target.value=p.toLowerCase()}})}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx(Q,{variant:"subtitle1",sx:{mb:1,color:"text.secondary"},children:"Phone Numbers"}),e.jsx(Ie,{name:"phone",children:({remove:$,push:p})=>e.jsxs(N,{children:[m.phone.map((l,i)=>e.jsxs(N,{sx:{display:"flex",alignItems:"center",gap:1,mb:2,p:2,backgroundColor:D("#f5f5f5",.5),borderRadius:1},children:[e.jsx(g,{component:k,name:`phone.${i}`,label:`Phone ${i+1}`,fullWidth:!0,variant:"outlined",error:b[`phone.${i}`]&&!!x[`phone.${i}`],helperText:b[`phone.${i}`]&&x[`phone.${i}`],InputProps:{startAdornment:e.jsx(pe,{position:"start",children:"📞"})}}),e.jsx(he,{onClick:()=>$(i),disabled:m.phone.length===1,sx:{color:"error.main","&:hover":{backgroundColor:D("#d32f2f",.1)}},children:e.jsx(ke,{})})]},i)),e.jsx(_,{startIcon:e.jsx(Z,{}),onClick:()=>p(""),variant:"outlined",sx:{mt:1},children:"Add Phone Number"})]})})]}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx(Q,{variant:"subtitle1",sx:{mb:1,color:"text.secondary"},children:"Email Addresses"}),e.jsx(Ie,{name:"email",children:({remove:$,push:p})=>e.jsxs(N,{children:[m.email.map((l,i)=>e.jsxs(N,{sx:{display:"flex",alignItems:"center",gap:1,mb:2,p:2,backgroundColor:D("#f5f5f5",.5),borderRadius:1},children:[e.jsx(g,{component:k,name:`email.${i}`,label:`Email ${i+1}`,fullWidth:!0,variant:"outlined",error:b[`email.${i}`]&&!!x[`email.${i}`],helperText:b[`email.${i}`]&&x[`email.${i}`],InputProps:{startAdornment:e.jsx(pe,{position:"start",children:"✉️"})}}),e.jsx(he,{onClick:()=>$(i),disabled:m.email.length===1,sx:{color:"error.main","&:hover":{backgroundColor:D("#d32f2f",.1)}},children:e.jsx(ke,{})})]},i)),e.jsx(_,{startIcon:e.jsx(Z,{}),onClick:()=>p(""),variant:"outlined",sx:{mt:1},children:"Add Email Address"})]})})]}),e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{component:k,name:"address",label:"Address",fullWidth:!0,variant:"outlined",multiline:!0,rows:3,error:b.address&&!!x.address,helperText:b.address&&x.address})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{component:k,name:"company",label:"Company Name",fullWidth:!0,variant:"outlined",error:b.company&&!!x.company,helperText:b.company&&x.company})}),T&&e.jsx(d,{item:!0,xs:12,children:e.jsx(Ge,{sx:{height:6,borderRadius:3}})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(N,{sx:{display:"flex",justifyContent:"center",mt:2},children:c?e.jsx(_,{variant:"contained",color:"primary",size:"large",onClick:()=>{P(),u(!1)},sx:{px:4,py:1.5,borderRadius:2,textTransform:"none",transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:"Customer Added! Click to Add New Customer"}):e.jsx(_,{variant:"contained",color:"primary",disabled:T||Object.keys(x).length>0,onClick:j,size:"large",sx:{px:4,py:1.5,borderRadius:2,textTransform:"none",transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:r?"Save Changes":"Add Customer"})})})]})})}),s&&e.jsx(Qe,{severity:"error",sx:{mt:2,borderRadius:1},children:s}),e.jsx(Xe,{open:S,autoHideDuration:5e3,onClose:()=>R(!1),message:r?"Customer Changed Successfully":"Customer added successfully",anchorOrigin:{vertical:"top",horizontal:"center"}})]})})},He=Se(ye)(({theme:r})=>({[`&.${qe.head}`]:{backgroundColor:D(r.palette.primary.main,.1),color:r.palette.primary.main,fontSize:"16px",fontWeight:600,borderBottom:`2px solid ${D(r.palette.primary.main,.2)}`},[`&.${qe.body}`]:{fontSize:"14px",transition:"all 0.2s ease-in-out"}})),Lr=Se(Ve)(({theme:r})=>({"&:nth-of-type(odd)":{backgroundColor:D(r.palette.primary.main,.02)},"&:hover":{backgroundColor:D(r.palette.primary.main,.05),transform:"scale(1.001)",transition:"all 0.2s ease-in-out"},"&:last-child td, &:last-child th":{border:0}})),Zr=Fe(Lr),st=({companyId:r,data:t,type:s,onDataUpdate:n})=>{const[c,u]=f.useState([]),[S,R]=f.useState([]),[F,A]=f.useState(""),[w,y]=f.useState(null),[v,O]=f.useState(null),[j,T]=f.useState(null),[P,m]=f.useState(null),x=ve("(max-width:1120px)"),b=ve(o=>o.breakpoints.down("mymd")),$=Be(),p=dr(),l=f.useCallback(async()=>{try{let o;if(t?o=t:s==="customers"?o=await U.fetchCustomers(r):s==="products"&&(o=await U.fetchProducts(r)),o&&o.length>0){if(s==="customers"){const a=o.map(h=>({...h,phone:Array.isArray(h.phone)?h.phone[0]:h.phone,email:Array.isArray(h.email)?h.email[0]:h.email}))}else processedData=o;u(Object.keys(processedData[0]).filter(a=>a!=="id"&&a!=="unitConversions"&&a!=="reorderPoint"&&a!=="sku"&&a!=="barcode"&&a!=="minimumStock")),R(processedData)}}catch(o){console.error("Failed to fetch data:",o)}},[r,s,t]),i=()=>{s==="products"?oe.mutate(w.id):te.mutate(w.id),R(o=>o.filter(a=>a.id!==w.id)),y(null)},X=o=>{y(o)},z=async(o,a)=>{if(m(o.currentTarget),console.log(a),O(a),s==="customers"){const h=await ie(a.id);T(h)}},C=()=>{m(null)},Y=()=>{C()},K=()=>{v&&(s==="products"?p(`/products/${v.id}`,{state:{product:v}}):s==="customers"&&p(`/customers/${v.id}`,{state:{customer:v}})),C()},{data:J,isError:ee,error:re}=ur([`api/${s}`,r],async()=>{if(s==="customers")return await U.fetchCustomers(r);if(s==="products")return await U.fetchProducts(r)},{staleTime:1e3*30,cacheTime:1e3*60*30,retry:1,enabled:!t}),W=t||J;f.useEffect(()=>{if(W&&W.length>0){u(Object.keys(W[0]).filter(a=>a!=="id"&&a!=="unitConversions"&&a!=="reorderPoint"&&a!=="sku"&&a!=="barcode"&&a!=="minimumStock"));const o=W.map(({phone:a,email:h,...E})=>({...E,phone:Array.isArray(a)&&a.length>0&&a[0]!==""?a[0]:a||null,email:Array.isArray(h)&&h.length>0?h[0]:h||null}));R(o)}},[W]);const q=De(),te=ue(o=>H.delete(`/api/customers/${o}`),{onSuccess:()=>{q.invalidateQueries([`api/${s}`,r]),l(),$(L.removeCustomer())},onError:o=>{console.error("Failed to delete customer:",o)}}),se=ue(o=>H.patch(`/api/products/${o.id}`,o),{onSuccess:o=>{q.invalidateQueries([`api/${s}`,r]);const a=o.data.product,h=mr(S,a);R(h),n&&n(a)},onError:o=>{console.error("Failed to edit product:",o)}}),oe=ue(o=>H.delete(`/api/products/${o}`),{onSuccess:()=>{q.invalidateQueries([`api/${s}`,r]),n&&n(),$(L.removeProduct())},onError:o=>{console.error("Failed to delete product:",o)}}),ne=ue(o=>H.patch(`/api/customers/${o.id}`,o),{onSuccess:o=>{q.invalidateQueries([`api/${s}`,r]),l()},onError:o=>{var a;console.error("Failed to edit customer:",((a=o.response)==null?void 0:a.data)||o.message)}}),ie=async o=>{try{return(await H.get(`/api/customers/${r}`)).data.customers.find(E=>E.id===o)}catch(a){return console.error("Failed to fetch full customer data:",a),v}};if(ee)return{error:re};const ae=S.filter(o=>{var a;return o.name.toLowerCase().includes(F.toLowerCase())||((a=o.company)==null?void 0:a.toLowerCase().includes(F.toLocaleLowerCase()))});return e.jsxs(me,{sx:{width:"100%",overflowX:"hidden",overflowY:"hidden",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(hr,{component:me,style:{overflowX:b&&"hidden",maxHeight:x?"70vh":"75vh",overflowY:"auto",borderRadius:"12px"},children:[e.jsx(gr,{onSearch:A}),e.jsxs(pr,{sx:{minWidth:650},size:x?"small":"medium",stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(xr,{children:e.jsxs(Ve,{children:[c.map((o,a)=>e.jsx(He,{align:"left",children:o.toUpperCase()},a)),e.jsx(He,{align:"center",children:"Actions"})]})}),e.jsx(br,{className:"table__body",children:e.jsx(fr,{children:ae.map((o,a)=>e.jsxs(Zr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2,delay:a*.05},children:[c.map(h=>e.jsx(ye,{align:"left",children:vr(o[h])},h)),e.jsx(ye,{align:"center",children:e.jsx(he,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:h=>z(h,o),sx:{transition:"transform 0.2s ease-in-out","&:hover":{transform:"scale(1.1)"}},children:e.jsx(Ye,{})})})]},o.id))})})]})]}),e.jsxs(jr,{anchorEl:P,keepMounted:!0,open:!!P,onClose:C,PaperProps:{sx:{borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}},children:[e.jsx(I,{onClick:()=>{Y(),C()},sx:{transition:"background-color 0.2s ease-in-out","&:hover":{backgroundColor:D((P==null?void 0:P.getAttribute("data-color"))||"#1976d2",.1)}},children:e.jsx(Ur,{title:s==="products"?"Edit Product":"Edit Customer",children:s==="products"?e.jsx(Wr,{editMutation:se,data:v,onProductUpdate:n}):e.jsx(Vr,{editMutation:ne,data:j||v})})}),e.jsx(I,{onClick:K,sx:{transition:"background-color 0.2s ease-in-out","&:hover":{backgroundColor:D("#1976d2",.1)}},children:"View"}),e.jsx(I,{onClick:()=>{C(),X(v)},sx:{color:"error.main",transition:"background-color 0.2s ease-in-out","&:hover":{backgroundColor:D("#d32f2f",.1)}},children:"Delete"})]}),e.jsxs(Re,{open:!!w,onClose:()=>y(null),PaperProps:{sx:{borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}},children:[e.jsx($e,{children:`Delete ${s==="products"?"Product":"Customer"} Confirmation`}),e.jsx(Ae,{children:e.jsx(Cr,{children:`Are you sure you want to delete this ${s==="products"?"product":"customer"}?`})}),e.jsxs(we,{children:[e.jsx(_,{onClick:()=>y(null),color:"primary",sx:{transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.05)"}},children:"Cancel"}),e.jsx(_,{onClick:i,color:"error",sx:{transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.05)"}},children:"Delete"})]})]})]})};export{tt as A,Vr as C,Wr as P,st as T,Ye as d};
