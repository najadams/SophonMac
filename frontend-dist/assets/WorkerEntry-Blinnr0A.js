import{r as y,Q as S,R as P,U as T,V as W,j as e,N as E,K as F,G as h,O as B,E as n,P as D,B as f,W as I,X as R,T as u,b,c as U,Y as L,Z as N,$ as O,L as q,a0 as A}from"./index-DKVd45z4.js";function M(l){return e.jsxs(u,{variant:"body2",color:"text.secondary",align:"center",...l,children:["Copyright Â© ",e.jsx(q,{color:"inherit",href:"https://mannos.netlify.app/",children:"Sophon"})," ",new Date().getFullYear(),"."]})}const z=F({palette:{primary:{main:"#2196f3"},secondary:{main:"#f50057"},background:{default:"#f5f5f5"}},typography:{fontFamily:'"Poppins", "Roboto", "Helvetica", "Arial", sans-serif'},components:{MuiButton:{styleOverrides:{root:{borderRadius:8,textTransform:"none",fontWeight:600}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:8}}}}}}),V=()=>{const[l,m]=y.useState(!1),j=S(),[x,o]=y.useState(null),v=P(),g=T(t=>{var a;return(a=t.companyState.data)==null?void 0:a.id});y.useEffect(()=>console.log(g,"from worker entry"));const{setUser:w}=W(),k=async(t,a,c)=>{var s,r,d;try{return(await A.post("/api/auth/account",{companyId:t,name:a,password:c})).data}catch(i){throw o(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to sign in. Please try again later."),new Error((d=i.response)==null?void 0:d.data)}},C=async t=>{m(!0),t.preventDefault(),o(null);const a=new FormData(t.currentTarget),c=a.get("name"),s=a.get("password");if(!c||!s){o("Please fill all fields"),m(!1);return}try{const r=await k(g,c.toLowerCase().trim(),s),d=r.worker.role,i=N[d]||[],p={...r.worker,permissions:i,password:r.worker.password};console.log(p,"userdata"),v(O.setCurrentUser(p)),w(p),j("/dashboard")}catch{}finally{m(!1)}};return e.jsx("div",{className:"notlogin",children:e.jsx(E,{theme:z,children:e.jsxs(h,{container:!0,component:"main",sx:{height:"100vh"},children:[e.jsx(B,{}),e.jsx(h,{item:!0,xs:!1,sm:4,md:7,sx:{backgroundImage:"url(/logo.png)",backgroundRepeat:"no-repeat",backgroundColor:t=>t.palette.mode==="light"?t.palette.grey[50]:t.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center",position:"relative",overflow:"hidden"},children:e.jsx(n.div,{initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:1},style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, rgba(33,150,243,0.3), rgba(245,0,87,0.3))"}})}),e.jsx(h,{item:!0,xs:12,sm:8,md:5,component:D,elevation:6,square:!0,children:e.jsxs(f,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(n.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:e.jsx(I,{sx:{m:1,bgcolor:"secondary.main",width:56,height:56},children:e.jsx(R,{})})}),e.jsxs(n.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.2},children:[e.jsx(u,{component:"h1",variant:"h4",sx:{fontWeight:600,mb:3},children:"Welcome Back"}),e.jsx(u,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Sign in to your worker account"})]}),e.jsxs(f,{component:"form",noValidate:!0,onSubmit:C,sx:{mt:1,width:"100%"},children:[e.jsx(n.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5,delay:.4},children:e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Name or Username",name:"name",onChange:()=>o(null),autoComplete:"name",autoFocus:!0})}),e.jsx(n.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5,delay:.6},children:e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:()=>o(null)})}),e.jsx(n.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:1},children:e.jsx(U,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2,py:1.5},disabled:l,children:l?e.jsx(L,{size:24}):"Sign In"})}),x&&e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(u,{variant:"body2",color:"error",align:"center",sx:{mt:2},children:x})}),e.jsx(M,{sx:{mt:5}})]})]})})]})})})};export{V as default};
