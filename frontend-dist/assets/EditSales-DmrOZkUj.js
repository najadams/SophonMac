import{Q as _e,b1 as He,U as re,r as p,y as Ke,j as e,E as ye,T as I,ax as be,ar as $,b as x,c as N,ah as Ye,ai as Ge,ab as Je,q as H,Y as Pe,b9 as ne,ba as ae,bb as K,bm as Y,bc as oe,a2 as je,a3 as O,aC as se,bn as D,br as Xe,bo as Ze,bp as Ve}from"./index-CVowLR_r.js";import{F as et,a as tt,b as C,c as rt}from"./formik.esm-DMAcCuh3.js";import{E as nt,R as at}from"./Error-BMWdOoAV.js";import{A as ie}from"./Autocomplete-DmDR8qSz.js";import{S as ot}from"./Snackbar-Cz1MwB4l.js";import"./usePreviousProps-DJLcVbf3.js";const st=be().shape({customerName:se().required("Customer name is required"),products:Xe().of(be().shape({name:se().required("Product name is required"),quantity:D().required("Quantity is required"),price:D().required("Price is required").min(1,"Quantity can't be less than 1")})),total:D().required(),amountPaid:D().required("Amount Paid should not be empty"),discount:D().min(0,"Discount cannot be negative"),paymentMethod:se().required("Payment method is required")}),xt=()=>{const ve=_e(),Ce=He(),{row:y}=Ce.state||{},B=re(t=>t.userState.currentUser),we=B.id,F=re(t=>t.companyState.data.id),U=re(t=>t.companyState.data);U!=null&&U.allowedUnits,U!=null&&U.allowedCategories;const[le,M]=p.useState(null),[f,Ne]=p.useState({}),[m,G]=p.useState({}),[Ue,it]=p.useState(!1),[$e,Me]=p.useState(!1),[Se,qe]=p.useState(!1),[Fe,Q]=p.useState(!1),[ce,J]=p.useState(""),k=Ke("(max-width:600px)"),[E,de]=p.useState(!1),ke=p.useRef(),[S,Te]=p.useState(null),Ie=new Date().toLocaleDateString(),[lt,R]=p.useState(""),[ue,w]=p.useState(!1),[Re,me]=p.useState([]),[W,X]=p.useState([]),[We,A]=p.useState(!1),[Ae,z]=p.useState(!1),pe=(t,n,r)=>{var i;if(!r||!t||isNaN(t))return 0;if(!n||n==="none"){let a=1,o=r.atomicUnit||r.baseUnit;r.conversionFactor&&r.conversionFactor>a&&(a=r.conversionFactor,o=r.baseUnit),r.conversions&&r.conversions.forEach(d=>{d.factor&&d.factor>a&&(a=d.factor,o=d.toUnit)}),n=o}if(n===r.atomicUnit)return t;if(n===r.baseUnit&&r.conversionFactor)return t*r.conversionFactor;const s=(i=r.conversions)==null?void 0:i.find(a=>a.toUnit===n);return s&&s.factor?t*s.factor:t};p.useEffect(()=>{(async()=>{const n=await O.fetchCustomersNames(F);me(["<<<< Add New Customer >>>>",...n])})()},[F]),p.useEffect(()=>{(async()=>{const n=await O.fetchProductNames(F);X([{id:1,name:"<<<< Add New Product >>>>"},...n])})()},[F]);const[_,Z]=p.useState(""),[he,V]=p.useState(""),[P,xe]=p.useState({name:"",salesPrice:"",costPrice:"",onhand:"",baseUnit:"none",allowsUnitBreakdown:!1,atomicUnit:"none",conversionFactor:1,potentialLoss:0}),Le=()=>{var t;if(y){console.log(y);const n=(t=y==null?void 0:y.detail)==null?void 0:t.map(i=>{const a=Math.ceil(i.salesPrice*(i.originalQuantity||i.quantity));return{name:i.name,quantity:i.originalQuantity||i.quantity,unit:i.salesUnit||"none",totalPrice:a,price:i.salesPrice}}),r=n.reduce((i,a)=>i+a.totalPrice,0);return{customerName:(y.customerCompany?`${$(y.customerCompany)} - ${$(y.customerName)}`:`None - ${$(y.customerName)}`)||"",products:n,total:r,amountPaid:y.amountPaid||"",discount:y.discount||0,paymentMethod:y.paymentMethod||"cash"}}else return{customerName:"",products:[{name:"",quantity:"",totalPrice:0,price:0}],total:0,amountPaid:"",discount:0,paymentMethod:"cash"}},fe=t=>{let n={};console.log(t.products);const r=t.products;return r&&r.forEach((s,i)=>{console.log(s.name,s.quantity,s.price),s.name||(n[`products.${i}.product`]=`Product ${i+1}'s name is required`),s.quantity||(n[`products.${i}.quantity`]=`Product ${i+1}'s quantity is required`),s.price||(n[`products.${i}.price`]=`Product ${i+1}'s price is required`)}),G(n),n},Oe=async(t,n,r)=>{var a;const s=t.products.reduce((o,d)=>o+((d==null?void 0:d.totalPrice)||0),0);t.total=s;const i=t.total-t.amountPaid-t.discount;try{const o=fe(t);if(Object.keys(o).length>0){console.log(o),M("Please fill in all required fields correctly.");return}if(!((a=t.customerName)!=null&&a.trim())){M("Customer Name should not be empty");return}if(t.amountPaid===void 0||t.amountPaid===""){M("Amount Paid should not be empty!");return}de(!0),n(!0);const d=await O.updateReceipt(y._id,{...t,balance:i},F,we);J("Receipt added successfully!");const l=Ze(W,t);X(l),Se&&Te({...t,balance:i}),setTimeout(()=>{ve("/sales")},1e3)}catch(o){console.log(o),M(o.message||"An error occurred")}finally{n(!1),de(!1)}},De=async()=>{try{if(w(!0),R(""),!_.trim()){R("Customer name is required"),w(!1);return}const n={name:_.trim().toLowerCase(),company:he.trim(),companyId:F},r=await O.addCustomer(n);if(!r||typeof r!="object"){M(typeof r=="string"?r:"Failed to add customer"),w(!1);return}R("");let s;r.company&&r.company.trim()?s=`${$(r.company)} - ${$(r.name)}`:s=$(r.name),console.log(r),s&&s.trim()?(me(i=>{const a=i.filter(o=>o!=="<<<< Add New Customer >>>>"&&o!==s);return["<<<< Add New Customer >>>>",s,...a]}),w(!1),A(!1),Z(""),V(""),R("")):(console.warn("Customer created but display name formatting failed:",r),w(!1),A(!1),Z(""),V(""),R(""))}catch(t){w(!1),t.response&&(console.log("error part"),M(t.response.message||"Failed to add new customer")),console.error("Error adding new customer:",t),w(!1),R(t.message||"Failed to add new customer")}},Be=async()=>{try{if(!Ve(P,Ne))return;w(!0);const t=P.name.trim().toLowerCase(),n=await O.addProduct({...P,name:t,companyId:F});if(!n||!n.data){const i=typeof n=="string"?n:(n==null?void 0:n.message)||"Failed to add product";throw new Error(i)}const r=n.data.data,s={id:r._id,name:$(r.name),salesPrice:r.salesPrice||0,onhand:r.onhand||0,baseUnit:r.defaultUnit||"none"};X(i=>{const a=i.filter(o=>o.name!=="<<<< Add New Product >>>>");return[{id:1,name:"<<<< Add New Product >>>>"},s,...a]}),z(!1),w(!1),xe({name:"",salesPrice:"",costPrice:"",onhand:"",baseUnit:"none",allowsUnitBreakdown:!1,atomicUnit:"none",conversionFactor:1,potentialLoss:0})}catch(t){w(!1),M(t.message||"Failed to add new product")}},q=t=>{const{name:n,value:r}=t.target;xe(s=>({...s,[n]:r}))},ge=t=>{if(!t)return["none"];const n=W.find(s=>s.name.toLowerCase()===t.toLowerCase());if(!n)return["none"];const r=[n.baseUnit];return n.conversions&&n.conversions.length>0&&n.conversions.forEach(s=>{r.includes(s.toUnit)||r.push(s.toUnit)}),r},ee=(t,n)=>{var i;const r=W.find(a=>a.name.toLowerCase()===t.toLowerCase());if(!r)return 0;if(console.log("getUnitPrice - Product:",r.name,"Unit:",n),console.log("getUnitPrice - Product conversions:",r.conversions),console.log("getUnitPrice - Base unit:",r.baseUnit,"Base price:",r.salesPrice),n===r.baseUnit)return console.log("getUnitPrice - Using base unit price:",r.salesPrice),r.salesPrice;const s=(i=r.conversions)==null?void 0:i.find(a=>a.toUnit===n);return s?(console.log("getUnitPrice - Found conversion:",s,"Price:",s.salesPrice),s.salesPrice):(console.log("getUnitPrice - No conversion found, using base price:",r.salesPrice),r.salesPrice)},Qe=t=>{if(t==="")return!0;const n=parseFloat(t);return!isNaN(n)&&n>=0};return e.jsxs(ye.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"page",children:[e.jsx("div",{className:"heading",style:{background:"none",marginBottom:"2rem"},children:e.jsxs(I,{variant:"h4",sx:{fontWeight:500,color:"#333",display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("i",{className:"bx bx-cart-add",style:{fontSize:"2rem",color:"#2196f3"}}),"Make Sales"]})}),e.jsx(et,{initialValues:Le(),validationSchema:st,onSubmit:(t,{setSubmitting:n,resetForm:r})=>{Oe(t,n)},children:({values:t,submitForm:n,setFieldValue:r,isSubmitting:s,resetForm:i})=>e.jsxs(tt,{className:"form",style:{margin:"1rem",padding:"2rem",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.05)"},children:[e.jsx(C,{name:"customerName",children:({field:a,form:o})=>{const d=!!(o.errors.customerName&&o.touched.customerName);return e.jsx(ie,{...a,autoHighlight:!0,options:$(Re),value:a.value,onChange:(l,c)=>{c==="<<<< Add New Customer >>>>"?(A(!0),o.setFieldValue(a.name,"")):o.setFieldValue(a.name,c||"")},renderInput:l=>e.jsx(x,{...l,style:{marginBottom:"1.5rem"},label:"Customer Name",fullWidth:!0,error:d,helperText:d?o.errors.customerName:"",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"},"& .MuiInputLabel-root":{color:"#666"}}})})}}),e.jsx("div",{style:{height:"2px",background:"linear-gradient(90deg, #2196f3, #f50057)",marginBottom:"2rem",borderRadius:"2px"}}),e.jsx(rt,{name:"products",children:({push:a,remove:o})=>{var d;return e.jsxs("div",{style:{display:"flex",gap:"1rem",flexDirection:"column"},children:[(d=t.products)==null?void 0:d.map((l,c)=>{const Ee=W.map(h=>(h==null?void 0:h.name)||"");return e.jsxs(ye.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:c*.1},style:{display:"flex",flex:1,gap:"1rem",flexWrap:"wrap",flexDirection:k?"column":"row",padding:"1.5rem",background:"#f8f9fa",borderRadius:"12px",marginBottom:"1rem",border:"1px solid #e0e0e0"},children:[e.jsx("div",{style:{width:"100%"},children:e.jsx(C,{name:`products.${c}.name`,children:({field:h,form:v})=>e.jsx(ie,{autoHighlight:!0,options:Ee,value:l.name?$(l.name):"",onChange:(u,g)=>{if(g==="<<<< Add New Product >>>>")z(!0),v.setFieldValue(h.name,"");else if(v.setFieldValue(h.name,g||""),g){const b=W.find(j=>j.name===g);if(b){r(`products.${c}.unit`,b.baseUnit);const j=l.quantity*b.salesPrice;r(`products.${c}.totalPrice`,Math.ceil(j)),r(`products.${c}.price`,b.salesPrice||0)}}},renderInput:u=>e.jsx(x,{...u,label:"Product Name",fullWidth:!0,error:!!(m!=null&&m[`products.${c}.product`]),helperText:(m==null?void 0:m[`products.${c}.product`])||"",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"},"& .MuiInputLabel-root":{color:"#666"}}})})})}),l.name&&e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[e.jsx(I,{variant:"caption",color:"textSecondary",children:"Available Units:"}),ge(l.name).map(h=>e.jsx(N,{size:"small",variant:"outlined",color:"primary",sx:{minWidth:"36px",height:"28px",padding:"0 8px"},onClick:()=>{r(`products.${c}.unit`,h);const v=ee(l.name,h);r(`products.${c}.price`,v);const u=Math.ceil(l.quantity*v);r(`products.${c}.totalPrice`,u)},children:h},h))]}),e.jsxs("div",{style:{display:"flex",gap:"0.8rem",flexWrap:"wrap",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flex:k?"1 1 100%":"2",minWidth:k?"100%":"200px"},children:[e.jsx(C,{name:`products.${c}.quantity`,children:({field:h,form:v})=>{const u=W.find(b=>b.name===l.name),g=l.unit||(u==null?void 0:u.baseUnit)||"none";return e.jsx(x,{...h,label:"Quantity",type:"number",step:"any",error:!!(m!=null&&m[`products.${c}.quantity`]),helperText:(m==null?void 0:m[`products.${c}.quantity`])||"",onChange:b=>{const j=b.target.value;if(!Qe(j)){G(te=>({...te,[`products.${c}.quantity`]:"Quantity cannot be negative"}));return}const T=parseFloat(j),L=pe(T,g,u);if(u!=null&&u.allowsUnitBreakdown&&g===u.baseUnit&&L%u.conversionFactor!==0&&(J(`Breaking down ${u.baseUnit} into ${u.atomicUnit} may result in potential loss of ${u.potentialLoss}%`),Q(!0)),v.setFieldValue(h.name,T),u){const te=ee(l.name,g),ze=Math.ceil(T*te);r(`products.${c}.totalPrice`,ze)}},onBlur:b=>{const j=parseFloat(b.target.value);if(isNaN(j)){G(L=>({...L,[`products.${c}.quantity`]:"Please enter a valid quantity"}));return}const T=pe(j,g,u);if(u&&T>u.onhand&&(U==null?void 0:U.enableStockValidationNotification)!==!1){const L=u.atomicUnit&&u.atomicUnit!=="none"?` ${u.atomicUnit}`:"";J(`Quantity cannot exceed available stock (${u.onhand}${L})`),Q(!0)}},variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"},"& .MuiInputLabel-root":{color:"#666"}}})}}),e.jsx(C,{name:`products.${c}.unit`,children:({field:h,form:v})=>{const u=ge(l.name);return e.jsx(ie,{...h,options:u,value:h.value||"none",style:{flex:"1",minWidth:"80px"},renderInput:g=>e.jsx(x,{...g,label:"Unit",error:!!(m!=null&&m[`products.${c}.unit`]),helperText:(m==null?void 0:m[`products.${c}.unit`])||"",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}}),onChange:(g,b)=>{v.setFieldValue(`products.${c}.unit`,b||"none");const j=ee(l.name,b);r(`products.${c}.price`,j);const T=Math.ceil(l.quantity*j);r(`products.${c}.totalPrice`,T)},freeSolo:!0,disableClearable:!0})}})]}),e.jsxs("div",{style:{display:"flex",gap:"0.8rem",flex:k?"1 1 100%":"3",flexWrap:"wrap",alignItems:"center"},children:[e.jsx(C,{name:`products.${c}.price`,children:({field:h})=>e.jsx(x,{...h,label:"Price",type:"number",style:{flex:k?"1 1 calc(50% - 0.4rem)":"1",minWidth:"100px"},error:!!(m!=null&&m[`products.${c}.price`]),helperText:(m==null?void 0:m[`products.${c}.price`])||"",variant:"outlined",onChange:v=>{const u=parseFloat(v.target.value);r(`products.${c}.price`,u);const g=l.quantity*u;r(`products.${c}.totalPrice`,Math.ceil(g)),fe(t)},sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"},"& .MuiInputLabel-root":{color:"#666"}}})}),e.jsx(C,{name:`products.${c}.totalPrice`,children:({field:h})=>e.jsx(x,{...h,value:l.totalPrice,label:"Total Price",readOnly:!0,style:{flex:k?"1 1 calc(50% - 0.4rem)":"1",minWidth:"100px"},variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px",backgroundColor:"#f5f5f5"},"& .MuiInputLabel-root":{color:"#666"}}})}),e.jsx(N,{variant:"contained",color:"error",onClick:()=>o(c),sx:{borderRadius:"8px",textTransform:"none",height:"40px",minWidth:"100px"},children:"Remove"})]})]})]},c)}),e.jsxs(N,{variant:"contained",color:"secondary",type:"button",onClick:()=>{a({name:"",quantity:"",unit:"none",totalPrice:0,price:0})},disabled:t.products.length>0&&!Object.values(t.products[t.products.length-1]).every(Boolean),sx:{borderRadius:"8px",textTransform:"none",height:"45px",marginTop:"1rem"},children:[e.jsx("i",{className:"bx bx-plus",style:{marginRight:"8px"}}),"Add Product"]})]})}}),e.jsxs("div",{style:{marginTop:"2rem",padding:k?"1rem":"1.5rem",background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsx(I,{variant:"h6",sx:{color:"#333"},children:"Total"}),e.jsx(C,{name:"total",children:()=>{var a;return e.jsxs(I,{variant:"h6",sx:{color:"#2196f3"},children:["₵",(a=t.products)==null?void 0:a.reduce((o,d)=>o+((d==null?void 0:d.totalPrice)||0),0)]})}})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",marginBottom:"1rem"},children:[e.jsx(C,{name:"amountPaid",children:({field:a,form:o})=>{const d=!!(o.errors.amountPaid&&o.touched.amountPaid);return e.jsx(x,{...a,label:"Amount Paid",type:"number",placeholder:"Amount Paid",fullWidth:!0,error:d,helperText:d?o.errors.amountPaid:"",variant:"outlined",onChange:l=>{r("amountPaid",l.target.value||0)},sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"},"& .MuiInputLabel-root":{color:"#666"}}})}}),e.jsx(C,{name:"discount",children:({field:a,form:o})=>{const d=!!(o.errors.discount&&o.touched.discount);return e.jsx(x,{...a,label:"Discount",type:"number",placeholder:"Discount",fullWidth:!0,error:d,helperText:d?o.errors.discount:"",variant:"outlined",onChange:l=>{r("discount",l.target.value)},sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"},"& .MuiInputLabel-root":{color:"#666"}}})}}),e.jsx(C,{name:"paymentMethod",children:({field:a,form:o})=>{const d=!!(o.errors.paymentMethod&&o.touched.paymentMethod);return e.jsxs(Ye,{fullWidth:!0,error:d,variant:"outlined",children:[e.jsx(Ge,{children:"Payment Method"}),e.jsxs(Je,{...a,label:"Payment Method",value:a.value||"cash",onChange:l=>{r("paymentMethod",l.target.value)},sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}},children:[e.jsx(H,{value:"cash",children:"Cash"}),e.jsx(H,{value:"card",children:"Card"}),e.jsx(H,{value:"mobile_money",children:"Mobile Money"}),e.jsx(H,{value:"bank_transfer",children:"Bank Transfer"})]}),d&&e.jsx(I,{variant:"caption",color:"error",sx:{mt:.5},children:o.errors.paymentMethod})]})}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0",width:"75%"},children:[e.jsx(I,{variant:"h6",sx:{color:"#333"},children:"Balance"}),e.jsx(C,{name:"balance",children:()=>{var a,o;return e.jsx(I,{variant:"h6",sx:{color:((a=t.products)==null?void 0:a.reduce((d,l)=>d+((l==null?void 0:l.totalPrice)||0),0))-t.amountPaid-t.discount>0?"#f44336":"#4caf50",fontWeight:600},children:((o=t.products)==null?void 0:o.reduce((d,l)=>d+((l==null?void 0:l.totalPrice)||0),0))-t.amountPaid-t.discount})}})]})]}),e.jsxs("div",{style:{position:"fixed",bottom:"2rem",right:"2rem",display:"flex",gap:"1rem",zIndex:1e3,background:"white",padding:"1rem",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[e.jsx(N,{variant:"contained",color:"primary",onClick:()=>{qe(!0),n()},disabled:E||s,sx:{borderRadius:"8px",textTransform:"none",height:"45px",minWidth:"150px"},children:E?e.jsx(Pe,{size:24}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bx bx-printer",style:{marginRight:"8px"}}),"Save and Print"]})}),e.jsx(N,{variant:"contained",color:"success",onClick:()=>{n()},disabled:E||s,sx:{borderRadius:"8px",textTransform:"none",height:"45px",minWidth:"120px"},children:E?e.jsx(Pe,{size:24}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bx bx-save",style:{marginRight:"8px"}}),"Save"]})})]})]})}),le&&e.jsx(nt,{error:le,onClose:()=>M(null)}),e.jsx(ot,{sx:{"& .MuiSnackbarContent-root":{color:Ue?"red":"white"}},open:$e,autoHideDuration:5e3,onClose:()=>Me(!1),message:ce||"Sales successfully Recorded",anchorOrigin:{vertical:"top",horizontal:"center"}}),e.jsxs(ne,{open:Fe,onClose:()=>Q(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ae,{id:"alert-dialog-title",children:"Insufficient Inventory"}),e.jsx(K,{children:e.jsx(Y,{id:"alert-dialog-description",children:ce})}),e.jsx(oe,{children:e.jsx(N,{autoFocus:!0,onClick:()=>Q(!1),color:"primary",children:"OK"})})]}),e.jsxs(ne,{open:We,onClose:()=>A(!1),"aria-labelledby":"new-customer-dialog-title","aria-describedby":"new-customer-dialog-description",children:[e.jsx(ae,{id:"new-customer-dialog-title",children:"Add New Customer"}),ue?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignContent:"center",width:316,height:300},children:e.jsx(je,{type:3})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(Y,{id:"new-customer-dialog-description",children:"Enter the name of the new customer:"}),e.jsx(x,{autoFocus:!0,margin:"dense",id:"new-customer-name",label:"Customer Name",type:"text",fullWidth:!0,variant:"standard",value:_,onChange:t=>Z(t.target.value.toLowerCase())})]}),e.jsxs(K,{children:[e.jsx(Y,{id:"new-customer-dialog-description",children:"Enter Company Name:"}),e.jsx(x,{autoFocus:!0,margin:"dense",id:"new-customer-company",label:"Company Name",type:"text",fullWidth:!0,variant:"standard",value:he,onChange:t=>V(t.target.value.toLowerCase())})]}),e.jsxs(oe,{children:[e.jsx(N,{onClick:()=>A(!1),color:"primary",children:"Cancel"}),_&&e.jsx(N,{onClick:De,color:"primary",children:"Add"})]})]})]}),e.jsxs(ne,{open:Ae,onClose:()=>z(!1),children:[e.jsx(ae,{children:"Add New Product"}),ue?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignContent:"center",width:600,height:316},children:e.jsx(je,{type:3})}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(Y,{children:"Please enter the details of the new product."}),e.jsx(x,{autoFocus:!0,margin:"dense",label:"Product Name",name:"name",fullWidth:!0,required:!0,value:P.name,onChange:q,error:!!f.name,helperText:f.name}),e.jsx(x,{margin:"dense",label:"Sales Price",type:"number",name:"salesPrice",fullWidth:!0,required:!0,value:P.salesPrice,onChange:q,error:!!f.salesPrice,helperText:f.salesPrice}),e.jsx(x,{margin:"dense",label:"Cost Price",type:"number",name:"costPrice",fullWidth:!0,required:!0,value:P.costPrice,onChange:q,error:!!f.costPrice,helperText:f.costPrice}),e.jsx(x,{margin:"dense",label:"Available Quantity",type:"number",name:"onhand",fullWidth:!0,required:!0,value:P.onhand,onChange:q,error:!!f.onhand,helperText:f.onhand}),e.jsx(x,{margin:"dense",label:"Base Unit (e.g., box, carton)",name:"baseUnit",fullWidth:!0,required:!0,value:P.baseUnit,onChange:q,error:!!f.baseUnit,helperText:f.baseUnit||"Primary unit for wholesale sales"}),P.allowsUnitBreakdown&&e.jsxs(e.Fragment,{children:[e.jsx(x,{margin:"dense",label:"Atomic Unit (e.g., piece, bottle)",name:"atomicUnit",fullWidth:!0,value:P.atomicUnit,onChange:q,error:!!f.atomicUnit,helperText:f.atomicUnit||"Smallest unit for retail sales"}),e.jsx(x,{margin:"dense",label:"Conversion Factor",type:"number",name:"conversionFactor",fullWidth:!0,value:P.conversionFactor,onChange:q,error:!!f.conversionFactor,helperText:f.conversionFactor||"How many atomic units in one base unit"}),e.jsx(x,{margin:"dense",label:"Potential Loss (%)",type:"number",name:"potentialLoss",fullWidth:!0,value:P.potentialLoss,onChange:q,error:!!f.potentialLoss,helperText:f.potentialLoss||"Estimated loss when breaking down units"})]})]}),e.jsxs(oe,{children:[e.jsx(N,{onClick:()=>z(!1),color:"primary",children:"Cancel"}),e.jsx(N,{onClick:Be,color:"primary",children:"Add Product"})]})]})]}),S&&e.jsx("div",{style:{display:"none"},children:e.jsx(at,{ref:ke,customerName:S.customerName,customerCompany:S.customerCompany,products:S.products,total:S.total,balance:S.balance,amountPaid:S.amountPaid,discount:S.discount,date:Ie,workerName:B.username?B.username:B.name})})]})};export{xt as default};
