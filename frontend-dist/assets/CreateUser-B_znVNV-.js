import{a4 as I,j as e,U as y,r as f,C as P,T as w,D as B,ax as W,G as l,ay as R,az as T,ap as q,aA as k,aB as z,B as g,c as F,ag as v,a3 as U,P as E,W as L,aC as c,I as O,b as V}from"./index-GTE1N4Ws.js";import{F as M,a as N,b as D,u as G}from"./formik.esm-gcJT4q9S.js";import{s as p,P as S}from"./styled-VNJnpstm.js";import{A as X}from"./Autocomplete-CB6kXBb8.js";import{I as b}from"./InputAdornment-C5JJzB5e.js";import{L as $}from"./Lock-DCBNiuEE.js";import{L as H}from"./LinearProgress-CkWFVjTZ.js";import{V as J,a as K}from"./VisibilityOff-BzeChkCx.js";import"./usePreviousProps-yVRdJcfX.js";const Q=I(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20"}),"AccountCircle"),A=p(V)({margin:"12px 0","& .MuiOutlinedInput-root":{"&:hover fieldset":{borderColor:"#1976d2"}}}),Y=p(E)({padding:"32px",marginTop:"24px",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"}),Z=p(g)({textAlign:"center",marginBottom:"32px"}),_=p(L)({width:80,height:80,margin:"0 auto 16px",backgroundColor:"#1976d2",fontSize:"2rem"}),ee=W().shape({name:c().required("Required"),username:c().required("Required"),role:c().required("Required"),email:c().email("Invalid email"),password:c().required("Required"),contact:c().required("Required")}),x=({label:j,icon:h,...a})=>{const[d,s,t]=G(a),[n,i]=f.useState(!1),m=r=>{if(a.name==="username"||a.name==="email"){const o=r.target.value.toLowerCase();t.setValue(o)}d.onBlur(r)},u=()=>{i(!n)};return e.jsx(A,{label:j,...d,...a,type:a.type==="password"&&n?"text":a.type,error:s.touched&&!!s.error,helperText:s.touched&&s.error,onBlur:m,InputProps:{startAdornment:h&&e.jsx(b,{position:"start",children:h}),endAdornment:a.type==="password"&&e.jsx(b,{position:"end",children:e.jsx(O,{onClick:u,edge:"end",size:"small",children:n?e.jsx(J,{}):e.jsx(K,{})})})}})},ce=()=>{const j=y(t=>t.companyState.data.id);y(t=>t.userState.currentUser.role);const[h,a]=f.useState(!1),[d,s]=f.useState("");return e.jsx("div",{className:"page",children:e.jsx(P,{maxWidth:"lg",children:e.jsxs(Y,{elevation:3,children:[e.jsxs(Z,{children:[e.jsx(_,{children:e.jsx(S,{fontSize:"large"})}),e.jsx(w,{variant:"h4",component:"h1",gutterBottom:!0,color:"primary",fontWeight:"bold",children:"Create New User"}),e.jsx(w,{variant:"body1",color:"text.secondary",children:"Add a new team member to your organization"}),e.jsx(B,{sx:{mt:2,mb:3}})]}),e.jsx(M,{initialValues:{name:"",username:"",role:"",email:"",password:"",contact:""},validationSchema:ee,onSubmit:async(t,{setSubmitting:n,resetForm:i})=>{var m,u;n(!0),s("");try{const r={companyId:j,name:t.name,username:t.username,contact:t.contact,password:t.password,role:t.role};t.email&&t.email.trim()&&(r.email=t.email),await U.addWorker(r),a(!0),setTimeout(()=>{a(!1),i()},1e3)}catch(r){const o=((u=(m=r==null?void 0:r.response)==null?void 0:m.data)==null?void 0:u.error)||(r==null?void 0:r.message)||r||"An error occurred while creating the user.";s(o),setTimeout(()=>{s("")},4e3),console.error("Error creating user:",r)}n(!1)},children:({values:t,setFieldValue:n,isSubmitting:i})=>e.jsxs(N,{children:[e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(x,{name:"name",label:"Full Name",variant:"outlined",fullWidth:!0,icon:e.jsx(R,{color:"action"})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(x,{name:"username",label:"Username",variant:"outlined",fullWidth:!0,icon:e.jsx(Q,{color:"action"})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(D,{name:"role",children:({field:m,form:u,meta:r})=>e.jsx(X,{options:Object.values(q),getOptionLabel:o=>o,renderInput:o=>e.jsx(A,{...o,label:"Role",variant:"outlined",error:r.touched&&!!r.error,helperText:r.touched&&r.error,InputProps:{...o.InputProps,startAdornment:e.jsx(b,{position:"start",children:e.jsx(T,{color:"action"})})}}),onChange:(o,C)=>{n("role",C)},value:t.role,disableClearable:!0})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(x,{name:"email",label:"Email Address (Optional)",variant:"outlined",fullWidth:!0,icon:e.jsx(k,{color:"action"})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(x,{name:"contact",label:"Phone Number",variant:"outlined",fullWidth:!0,icon:e.jsx(z,{color:"action"})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(x,{name:"password",label:"Password",type:"password",variant:"outlined",fullWidth:!0,icon:e.jsx($,{color:"action"})})})]}),i&&e.jsx(g,{mt:3,children:e.jsx(H,{sx:{borderRadius:2,height:6}})}),e.jsx(g,{mt:4,children:e.jsx(F,{type:"submit",variant:"contained",color:"primary",disabled:i,size:"large",fullWidth:!0,startIcon:e.jsx(S,{}),sx:{py:1.5,fontSize:"1.1rem",fontWeight:"bold",borderRadius:3,background:"linear-gradient(45deg, #1976d2 30%, #42a5f5 90%)",boxShadow:"0 4px 20px rgba(25, 118, 210, 0.3)","&:hover":{background:"linear-gradient(45deg, #1565c0 30%, #1976d2 90%)",boxShadow:"0 6px 25px rgba(25, 118, 210, 0.4)"}},children:i?"Creating User...":"Create User"})}),d&&e.jsx("div",{style:{position:"fixed",top:"80px",left:"50%",transform:"translateX(-50%)",zIndex:1e3},children:e.jsx(v,{variant:"filled",severity:"error",children:d})}),h&&!d&&e.jsx("div",{style:{position:"fixed",top:"80px",left:"50%",transform:"translateX(-50%)",zIndex:1e3},children:e.jsx(v,{variant:"filled",severity:"success",children:"User created successfully!"})})]})})]})})})};export{ce as default};
